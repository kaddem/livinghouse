$(document).ready(function(){

  console.log('yep, jQuery work!');
  $('.promo-slider').slick({
    dots: true
    // autoplay: true,
    // autoplaySpeed: 500
  });

  // $('.review__slider-preview-item')
  // 

  $('.review__slider-big').slick({
    slidesToShow: 1,
    slidesToScroll: 1,
    arrows: false,
    fade: true,
    asNavFor: '.review__slider-preview'
  });

  $('.review__slider-preview').slick({
    slidesToShow: 4,
    slidesToScroll: 1,
    asNavFor: '.review__slider-big',
    dots: false,
    centerMode: false,
    focusOnSelect: true,
    responsive: [
      {
        breakpoint: 1200,
        settings: {
          slidesToShow: 2
        }
      }
      // },
      // {
      //   breakpoint: 768,
      //   settings: {
      //     slidesToShow: 0,
      //     settings: "unslick"
      //   }
      // }
      // You can unslick at a given breakpoint now by adding:
      // settings: "unslick"
      // instead of a settings object
    ]
  });

});

$(window).load(function () {
  function ratioPhoto(block) {
    $(block).each(function(){
      var itemWidth = $(this).width();
      var itemHeight = $(this).height();
      var itemRatio = itemHeight / itemWidth;

      var photo = $(this).find('img');
      var photoWidth = photo.width();
      var photoHeight = photo.height();
      var photoRatio = photoHeight / photoWidth;

      if ( itemRatio < photoRatio ) {
        photo.width('100%');
        photo.height('auto');
      } else if (itemRatio > photoRatio) {
        photo.height('100%');
        photo.width('auto');
      } else {
        photo.width('100%');
        photo.height('auto');
      }
    });
  }

  function ratioLetter(block) {
    $(block).each(function(){
      var itemWidth = $(this).width();
      var itemHeight = $(this).height();
      var itemRatio = itemHeight / itemWidth;

      var photo = $(this).find('img');
      var photoWidth = photo.width();
      var photoHeight = photo.height();
      var photoRatio = photoHeight / photoWidth;

      if ( itemRatio > photoRatio ) {
        photo.width('100%');
      } else if (itemRatio < photoRatio) {
        photo.height('100%');
      } else {
        photo.width('100%');
      }
    });
  }

  ratioPhoto('.review__slider-preview-item');
  ratioPhoto('.review__slider-big-item');
  ratioLetter('.review__letter-box');
  ratioLetter('.review__chart-box');
  ratioPhoto('.gallery__item');
  ratioPhoto('.project-card__photo');
  ratioPhoto('.review-card__visual');
  ratioPhoto('.project__photo');

  $(window).resize(function(){
    ratioPhoto('.review__slider-preview-item');
    ratioPhoto('.review__slider-big-item');
    ratioLetter('.review__letter-box');
    ratioLetter('.review__chart-box');
    ratioPhoto('.gallery__item');
    ratioPhoto('.project-card__photo');
    ratioPhoto('.review-card__visual');
    ratioPhoto('.project__photo');
  });

  function tabs(boxTabsLink, boxTabsContent, tabs){ 
    $(boxTabsLink + ' input').on('click', function(e){
      var attrLink = $(this).attr('id');
      console.log(attrLink);
      $(boxTabsContent + ' ' + tabs).css("display", "none");
      $(boxTabsContent + ' .' + attrLink).css("display", "block");
    }); 
  };


  tabs('#tabs-roof', '#tabs-roof-content', '.project-form__table-select--roof-content');
  tabs('#tabs-frame', '#tabs-frame-content', '.project-form__tab-item');



  // бургер, что тут еще скажешь? но без колы(
  $('.burger').on('click', function(e){
      e.preventDefault();
      if ( $(this).hasClass("burger--close") ) {
          $(this).removeClass('burger--close');
          $('.main-nav').slideUp(400);
          $('.main-nav').removeClass('main-nav--open');
          $('.page-header').removeClass('page-header--open');
      } else {
          $(this).addClass('burger--close');
          $('.main-nav').slideDown(400);
          $('.main-nav').addClass('main-nav--open');
          $('.page-header').addClass('page-header--open');
      }
  });

  $('.nav ul a').on('click', function(e){
      if ($(window).width() < 768) {
          $('.main-nav').slideUp(400);
          $('.burger').addClass('burger--open');
          $('.burger').removeClass('burger--close');
      };
  });


  $(window).resize(function(){
      if( $(window).width() > 767 ) {
          $('.main-nav').show();
      } else {
          $('.main-nav').slideUp(400);
          $('.main-nav').removeClass('main-nav--open');
          $('.page-header').removeClass('page-header--open');
          $('.burger').removeClass('burger--close');
      }
  });

  $(window).on('scroll', function(e) { // отслеживаем событие на элементе window
    if( $(window).width() < 768 ) {
        $('.main-nav').slideUp(400);
        $('.main-nav').removeClass('main-nav--open');
        $('.page-header').removeClass('page-header--open');
        $('.burger').removeClass('burger--close');
    }
  });

  if ( $(window).scrollTop() > 100 && $(window).width() > 767) {
    $('.page-header').addClass('page-header--scroll');
    $('.page-header').addClass('page-header--desktop');
  } else if ( $(window).scrollTop() > 100 ) {
    $('.page-header').addClass('page-header--scroll');
  }

  $(window).on('scroll', function(e) {

    if ( $(window).scrollTop() > 100 && $(window).width() > 1199 ) {
      $('.page-header').addClass('page-header--scroll');
      $('.page-header').addClass('page-header--desktop');
    } else if ( $(window).scrollTop() > 100 ) {
      $('.page-header').addClass('page-header--scroll');
      $('.page-header').removeClass('page-header--desktop');
    } else {
      $('.page-header').removeClass('page-header--scroll');
      $('.page-header').removeClass('page-header--desktop');
    }

  });

  function telMask(selector) {
    $(selector).mask('+7 (000) 000-00-00');
  }

  telMask('.contact-form__input--tel');
  telMask('.consult__input-tel');


  // Ползунок для форм
  
  function sliderForm(inputStart, inputEnd) {
    var priceStart = $(inputStart).data('price-start');
    console.log(priceStart);
    var priceEnd = $(inputEnd).data('price-end');
    console.log(priceStart);

    $( "#form-slider-ui" ).slider({
      // orientation: "vertical",
      // step: 15,
      range: true,
      min: priceStart,
      max: priceEnd,
      values: [ priceStart, priceEnd ],
      slide: function( event, ui ) {
        $( "#amount_start" ).val( ui.values[ 0 ] );
        $( "#amount_end" ).val( ui.values[ 1 ] );
      }
    });
    $( "#amount_start" ).val( $( "#form-slider-ui" ).slider( "values", 0 ) );
    $( "#amount_end" ).val( $( "#form-slider-ui" ).slider( "values", 1 ) );

    // Изменение местоположения ползунка при вводиде данных в первый элемент input
    $("input#amount").change(function(){
      var value1=$("input#amount_start").val();
      var value2=$("input#amount_1").val();
        if(parseInt(value1) > parseInt(value2)){
        value1 = value2;
        $("input#amount_start").val(value1);
      }
      $("#form-slider-ui").slider("values",0,value1); 
    });
        
    // Изменение местоположения ползунка при вводиде данных в второй элемент input  
    $("input#amount_1").change(function(){
      var value1=$("input#amount_start").val();
      var value2=$("input#amount_end").val();

      if(parseInt(value1) > parseInt(value2)){
        value2 = value1;
        $("input#amount_end").val(value2);
      }
      $("#form-slider-ui").slider("values",1,value2);
    });

    // фильтрация ввода в поля
    jQuery('#amount_start, #amount_end').keypress(function(event){
      var key, keyChar;
      if(!event) var event = window.event;
      
      if (event.keyCode) key = event.keyCode;
      else if(event.which) key = event.which;
    
      if(key==null || key==0 || key==8 || key==13 || key==9 || key==46 || key==37 || key==39 ) return true;
      keyChar=String.fromCharCode(key);
      
      if(!/\d/.test(keyChar)) return false;
    
    });

  }

  sliderForm('.form__cost--start', '.form__cost--end');
  sliderForm('.projects-filter__cost--start', '.projects-filter__cost--end')


  // Закрытие дропдаунов по клику вне их
  // 
  function closeOutDropdown(dropDown, input) {

    $(document).mouseup(function (e){ // событие клика по веб-документу
      var drop = $(dropDown); // тут указываем ID элемента
      var inp = $(input);
      if (inp.is(e.target)) {
        return;
      } else if (!drop.is(e.target) // если клик был не по нашему блоку
          && drop.has(e.target).length === 0) { // и не по его дочерним элементам
        drop.hide(); // скрываем его
      } 
    });

  }

  closeOutDropdown('.form__dropdown', '.form__selected');
  closeOutDropdown('.projects-filter__dropdown', '.projects-filter__selected');
  closeOutDropdown('.form-review__dropdown', '.form-review__selected');

  function clickSelect(select, dropList){

    $(select).on('click', function(e){
    
      var dropDown = $(this).find(dropList);
      var everDropDown = $(dropList);
      
      if ( dropDown.is(':visible') ) {
        everDropDown.hide();
      } else if ( dropDown.is(':hidden') ) {
        everDropDown.hide();
        dropDown.show();
      } 
      
    });

  }

  clickSelect('.form__select', '.form__dropdown');
  clickSelect('.projects-filter__select', '.projects-filter__dropdown');
  clickSelect('.form-review__select', '.form-review__dropdown');

  


  // Закрытие дроптадунов по клику на другой селект
  // 
  // 
  // 
  $(function(){

    var dateEnd = $('#countdown-promo').data('timer-hours');
  
    var note = $('#note'),
      ts = new Date(2012, 0, 1),
      newYear = true;
    
    if((new Date()) > ts){
      // The new year is here! Count towards something else.
      // Notice the *1000 at the end - time must be in milliseconds
      ts = (new Date()).getTime() + dateEnd*24*60*60*1000;
      newYear = false;
    }


      
    $('#countdown-promo').countdown({
      timestamp : ts,
      callback  : function(days, hours, minutes, seconds){
        
        var message = "";
        
        message += days + " day" + ( days==1 ? '':'s' ) + ", ";
        message += hours + " hour" + ( hours==1 ? '':'s' ) + ", ";
        message += minutes + " minute" + ( minutes==1 ? '':'s' ) + " and ";
        message += seconds + " second" + ( seconds==1 ? '':'s' ) + " <br />";
        
        if(newYear){
          message += "left until the new year!";
        }
        else {
          message += "left to 10 days from now!";
        }
        
        note.html(message);
      }
    });
    
  });


});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XHJcblxyXG4gIGNvbnNvbGUubG9nKCd5ZXAsIGpRdWVyeSB3b3JrIScpO1xyXG4gICQoJy5wcm9tby1zbGlkZXInKS5zbGljayh7XHJcbiAgICBkb3RzOiB0cnVlXHJcbiAgICAvLyBhdXRvcGxheTogdHJ1ZSxcclxuICAgIC8vIGF1dG9wbGF5U3BlZWQ6IDUwMFxyXG4gIH0pO1xyXG5cclxuICAvLyAkKCcucmV2aWV3X19zbGlkZXItcHJldmlldy1pdGVtJylcclxuICAvLyBcclxuXHJcbiAgJCgnLnJldmlld19fc2xpZGVyLWJpZycpLnNsaWNrKHtcclxuICAgIHNsaWRlc1RvU2hvdzogMSxcclxuICAgIHNsaWRlc1RvU2Nyb2xsOiAxLFxyXG4gICAgYXJyb3dzOiBmYWxzZSxcclxuICAgIGZhZGU6IHRydWUsXHJcbiAgICBhc05hdkZvcjogJy5yZXZpZXdfX3NsaWRlci1wcmV2aWV3J1xyXG4gIH0pO1xyXG5cclxuICAkKCcucmV2aWV3X19zbGlkZXItcHJldmlldycpLnNsaWNrKHtcclxuICAgIHNsaWRlc1RvU2hvdzogNCxcclxuICAgIHNsaWRlc1RvU2Nyb2xsOiAxLFxyXG4gICAgYXNOYXZGb3I6ICcucmV2aWV3X19zbGlkZXItYmlnJyxcclxuICAgIGRvdHM6IGZhbHNlLFxyXG4gICAgY2VudGVyTW9kZTogZmFsc2UsXHJcbiAgICBmb2N1c09uU2VsZWN0OiB0cnVlLFxyXG4gICAgcmVzcG9uc2l2ZTogW1xyXG4gICAgICB7XHJcbiAgICAgICAgYnJlYWtwb2ludDogMTIwMCxcclxuICAgICAgICBzZXR0aW5nczoge1xyXG4gICAgICAgICAgc2xpZGVzVG9TaG93OiAyXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8vIH0sXHJcbiAgICAgIC8vIHtcclxuICAgICAgLy8gICBicmVha3BvaW50OiA3NjgsXHJcbiAgICAgIC8vICAgc2V0dGluZ3M6IHtcclxuICAgICAgLy8gICAgIHNsaWRlc1RvU2hvdzogMCxcclxuICAgICAgLy8gICAgIHNldHRpbmdzOiBcInVuc2xpY2tcIlxyXG4gICAgICAvLyAgIH1cclxuICAgICAgLy8gfVxyXG4gICAgICAvLyBZb3UgY2FuIHVuc2xpY2sgYXQgYSBnaXZlbiBicmVha3BvaW50IG5vdyBieSBhZGRpbmc6XHJcbiAgICAgIC8vIHNldHRpbmdzOiBcInVuc2xpY2tcIlxyXG4gICAgICAvLyBpbnN0ZWFkIG9mIGEgc2V0dGluZ3Mgb2JqZWN0XHJcbiAgICBdXHJcbiAgfSk7XHJcblxyXG59KTtcclxuXHJcbiQod2luZG93KS5sb2FkKGZ1bmN0aW9uICgpIHtcclxuICBmdW5jdGlvbiByYXRpb1Bob3RvKGJsb2NrKSB7XHJcbiAgICAkKGJsb2NrKS5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgIHZhciBpdGVtV2lkdGggPSAkKHRoaXMpLndpZHRoKCk7XHJcbiAgICAgIHZhciBpdGVtSGVpZ2h0ID0gJCh0aGlzKS5oZWlnaHQoKTtcclxuICAgICAgdmFyIGl0ZW1SYXRpbyA9IGl0ZW1IZWlnaHQgLyBpdGVtV2lkdGg7XHJcblxyXG4gICAgICB2YXIgcGhvdG8gPSAkKHRoaXMpLmZpbmQoJ2ltZycpO1xyXG4gICAgICB2YXIgcGhvdG9XaWR0aCA9IHBob3RvLndpZHRoKCk7XHJcbiAgICAgIHZhciBwaG90b0hlaWdodCA9IHBob3RvLmhlaWdodCgpO1xyXG4gICAgICB2YXIgcGhvdG9SYXRpbyA9IHBob3RvSGVpZ2h0IC8gcGhvdG9XaWR0aDtcclxuXHJcbiAgICAgIGlmICggaXRlbVJhdGlvIDwgcGhvdG9SYXRpbyApIHtcclxuICAgICAgICBwaG90by53aWR0aCgnMTAwJScpO1xyXG4gICAgICAgIHBob3RvLmhlaWdodCgnYXV0bycpO1xyXG4gICAgICB9IGVsc2UgaWYgKGl0ZW1SYXRpbyA+IHBob3RvUmF0aW8pIHtcclxuICAgICAgICBwaG90by5oZWlnaHQoJzEwMCUnKTtcclxuICAgICAgICBwaG90by53aWR0aCgnYXV0bycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHBob3RvLndpZHRoKCcxMDAlJyk7XHJcbiAgICAgICAgcGhvdG8uaGVpZ2h0KCdhdXRvJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmF0aW9MZXR0ZXIoYmxvY2spIHtcclxuICAgICQoYmxvY2spLmVhY2goZnVuY3Rpb24oKXtcclxuICAgICAgdmFyIGl0ZW1XaWR0aCA9ICQodGhpcykud2lkdGgoKTtcclxuICAgICAgdmFyIGl0ZW1IZWlnaHQgPSAkKHRoaXMpLmhlaWdodCgpO1xyXG4gICAgICB2YXIgaXRlbVJhdGlvID0gaXRlbUhlaWdodCAvIGl0ZW1XaWR0aDtcclxuXHJcbiAgICAgIHZhciBwaG90byA9ICQodGhpcykuZmluZCgnaW1nJyk7XHJcbiAgICAgIHZhciBwaG90b1dpZHRoID0gcGhvdG8ud2lkdGgoKTtcclxuICAgICAgdmFyIHBob3RvSGVpZ2h0ID0gcGhvdG8uaGVpZ2h0KCk7XHJcbiAgICAgIHZhciBwaG90b1JhdGlvID0gcGhvdG9IZWlnaHQgLyBwaG90b1dpZHRoO1xyXG5cclxuICAgICAgaWYgKCBpdGVtUmF0aW8gPiBwaG90b1JhdGlvICkge1xyXG4gICAgICAgIHBob3RvLndpZHRoKCcxMDAlJyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoaXRlbVJhdGlvIDwgcGhvdG9SYXRpbykge1xyXG4gICAgICAgIHBob3RvLmhlaWdodCgnMTAwJScpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHBob3RvLndpZHRoKCcxMDAlJyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmF0aW9QaG90bygnLnJldmlld19fc2xpZGVyLXByZXZpZXctaXRlbScpO1xyXG4gIHJhdGlvUGhvdG8oJy5yZXZpZXdfX3NsaWRlci1iaWctaXRlbScpO1xyXG4gIHJhdGlvTGV0dGVyKCcucmV2aWV3X19sZXR0ZXItYm94Jyk7XHJcbiAgcmF0aW9MZXR0ZXIoJy5yZXZpZXdfX2NoYXJ0LWJveCcpO1xyXG4gIHJhdGlvUGhvdG8oJy5nYWxsZXJ5X19pdGVtJyk7XHJcbiAgcmF0aW9QaG90bygnLnByb2plY3QtY2FyZF9fcGhvdG8nKTtcclxuICByYXRpb1Bob3RvKCcucmV2aWV3LWNhcmRfX3Zpc3VhbCcpO1xyXG4gIHJhdGlvUGhvdG8oJy5wcm9qZWN0X19waG90bycpO1xyXG5cclxuICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCl7XHJcbiAgICByYXRpb1Bob3RvKCcucmV2aWV3X19zbGlkZXItcHJldmlldy1pdGVtJyk7XHJcbiAgICByYXRpb1Bob3RvKCcucmV2aWV3X19zbGlkZXItYmlnLWl0ZW0nKTtcclxuICAgIHJhdGlvTGV0dGVyKCcucmV2aWV3X19sZXR0ZXItYm94Jyk7XHJcbiAgICByYXRpb0xldHRlcignLnJldmlld19fY2hhcnQtYm94Jyk7XHJcbiAgICByYXRpb1Bob3RvKCcuZ2FsbGVyeV9faXRlbScpO1xyXG4gICAgcmF0aW9QaG90bygnLnByb2plY3QtY2FyZF9fcGhvdG8nKTtcclxuICAgIHJhdGlvUGhvdG8oJy5yZXZpZXctY2FyZF9fdmlzdWFsJyk7XHJcbiAgICByYXRpb1Bob3RvKCcucHJvamVjdF9fcGhvdG8nKTtcclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gdGFicyhib3hUYWJzTGluaywgYm94VGFic0NvbnRlbnQsIHRhYnMpeyBcclxuICAgICQoYm94VGFic0xpbmsgKyAnIGlucHV0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgIHZhciBhdHRyTGluayA9ICQodGhpcykuYXR0cignaWQnKTtcclxuICAgICAgY29uc29sZS5sb2coYXR0ckxpbmspO1xyXG4gICAgICAkKGJveFRhYnNDb250ZW50ICsgJyAnICsgdGFicykuY3NzKFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XHJcbiAgICAgICQoYm94VGFic0NvbnRlbnQgKyAnIC4nICsgYXR0ckxpbmspLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcclxuICAgIH0pOyBcclxuICB9O1xyXG5cclxuXHJcbiAgdGFicygnI3RhYnMtcm9vZicsICcjdGFicy1yb29mLWNvbnRlbnQnLCAnLnByb2plY3QtZm9ybV9fdGFibGUtc2VsZWN0LS1yb29mLWNvbnRlbnQnKTtcclxuICB0YWJzKCcjdGFicy1mcmFtZScsICcjdGFicy1mcmFtZS1jb250ZW50JywgJy5wcm9qZWN0LWZvcm1fX3RhYi1pdGVtJyk7XHJcblxyXG5cclxuXHJcbiAgLy8g0LHRg9GA0LPQtdGALCDRh9GC0L4g0YLRg9GCINC10YnQtSDRgdC60LDQttC10YjRjD8g0L3QviDQsdC10Lcg0LrQvtC70YsoXHJcbiAgJCgnLmJ1cmdlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGlmICggJCh0aGlzKS5oYXNDbGFzcyhcImJ1cmdlci0tY2xvc2VcIikgKSB7XHJcbiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdidXJnZXItLWNsb3NlJyk7XHJcbiAgICAgICAgICAkKCcubWFpbi1uYXYnKS5zbGlkZVVwKDQwMCk7XHJcbiAgICAgICAgICAkKCcubWFpbi1uYXYnKS5yZW1vdmVDbGFzcygnbWFpbi1uYXYtLW9wZW4nKTtcclxuICAgICAgICAgICQoJy5wYWdlLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdwYWdlLWhlYWRlci0tb3BlbicpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYnVyZ2VyLS1jbG9zZScpO1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2Jykuc2xpZGVEb3duKDQwMCk7XHJcbiAgICAgICAgICAkKCcubWFpbi1uYXYnKS5hZGRDbGFzcygnbWFpbi1uYXYtLW9wZW4nKTtcclxuICAgICAgICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tb3BlbicpO1xyXG4gICAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoJy5uYXYgdWwgYScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCA3NjgpIHtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnNsaWRlVXAoNDAwKTtcclxuICAgICAgICAgICQoJy5idXJnZXInKS5hZGRDbGFzcygnYnVyZ2VyLS1vcGVuJyk7XHJcbiAgICAgICAgICAkKCcuYnVyZ2VyJykucmVtb3ZlQ2xhc3MoJ2J1cmdlci0tY2xvc2UnKTtcclxuICAgICAgfTtcclxuICB9KTtcclxuXHJcblxyXG4gICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKXtcclxuICAgICAgaWYoICQod2luZG93KS53aWR0aCgpID4gNzY3ICkge1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2Jykuc2hvdygpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2Jykuc2xpZGVVcCg0MDApO1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2JykucmVtb3ZlQ2xhc3MoJ21haW4tbmF2LS1vcGVuJyk7XHJcbiAgICAgICAgICAkKCcucGFnZS1oZWFkZXInKS5yZW1vdmVDbGFzcygncGFnZS1oZWFkZXItLW9wZW4nKTtcclxuICAgICAgICAgICQoJy5idXJnZXInKS5yZW1vdmVDbGFzcygnYnVyZ2VyLS1jbG9zZScpO1xyXG4gICAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oZSkgeyAvLyDQvtGC0YHQu9C10LbQuNCy0LDQtdC8INGB0L7QsdGL0YLQuNC1INC90LAg0Y3Qu9C10LzQtdC90YLQtSB3aW5kb3dcclxuICAgIGlmKCAkKHdpbmRvdykud2lkdGgoKSA8IDc2OCApIHtcclxuICAgICAgICAkKCcubWFpbi1uYXYnKS5zbGlkZVVwKDQwMCk7XHJcbiAgICAgICAgJCgnLm1haW4tbmF2JykucmVtb3ZlQ2xhc3MoJ21haW4tbmF2LS1vcGVuJyk7XHJcbiAgICAgICAgJCgnLnBhZ2UtaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1vcGVuJyk7XHJcbiAgICAgICAgJCgnLmJ1cmdlcicpLnJlbW92ZUNsYXNzKCdidXJnZXItLWNsb3NlJyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGlmICggJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMTAwICYmICQod2luZG93KS53aWR0aCgpID4gNzY3KSB7XHJcbiAgICAkKCcucGFnZS1oZWFkZXInKS5hZGRDbGFzcygncGFnZS1oZWFkZXItLXNjcm9sbCcpO1xyXG4gICAgJCgnLnBhZ2UtaGVhZGVyJykuYWRkQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1kZXNrdG9wJyk7XHJcbiAgfSBlbHNlIGlmICggJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMTAwICkge1xyXG4gICAgJCgnLnBhZ2UtaGVhZGVyJykuYWRkQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1zY3JvbGwnKTtcclxuICB9XHJcblxyXG4gICQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oZSkge1xyXG5cclxuICAgIGlmICggJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMTAwICYmICQod2luZG93KS53aWR0aCgpID4gMTE5OSApIHtcclxuICAgICAgJCgnLnBhZ2UtaGVhZGVyJykuYWRkQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1zY3JvbGwnKTtcclxuICAgICAgJCgnLnBhZ2UtaGVhZGVyJykuYWRkQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1kZXNrdG9wJyk7XHJcbiAgICB9IGVsc2UgaWYgKCAkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAxMDAgKSB7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tc2Nyb2xsJyk7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdwYWdlLWhlYWRlci0tZGVza3RvcCcpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgJCgnLnBhZ2UtaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1zY3JvbGwnKTtcclxuICAgICAgJCgnLnBhZ2UtaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1kZXNrdG9wJyk7XHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiB0ZWxNYXNrKHNlbGVjdG9yKSB7XHJcbiAgICAkKHNlbGVjdG9yKS5tYXNrKCcrNyAoMDAwKSAwMDAtMDAtMDAnKTtcclxuICB9XHJcblxyXG4gIHRlbE1hc2soJy5jb250YWN0LWZvcm1fX2lucHV0LS10ZWwnKTtcclxuICB0ZWxNYXNrKCcuY29uc3VsdF9faW5wdXQtdGVsJyk7XHJcblxyXG5cclxuICAvLyDQn9C+0LvQt9GD0L3QvtC6INC00LvRjyDRhNC+0YDQvFxyXG4gIFxyXG4gIGZ1bmN0aW9uIHNsaWRlckZvcm0oaW5wdXRTdGFydCwgaW5wdXRFbmQpIHtcclxuICAgIHZhciBwcmljZVN0YXJ0ID0gJChpbnB1dFN0YXJ0KS5kYXRhKCdwcmljZS1zdGFydCcpO1xyXG4gICAgY29uc29sZS5sb2cocHJpY2VTdGFydCk7XHJcbiAgICB2YXIgcHJpY2VFbmQgPSAkKGlucHV0RW5kKS5kYXRhKCdwcmljZS1lbmQnKTtcclxuICAgIGNvbnNvbGUubG9nKHByaWNlU3RhcnQpO1xyXG5cclxuICAgICQoIFwiI2Zvcm0tc2xpZGVyLXVpXCIgKS5zbGlkZXIoe1xyXG4gICAgICAvLyBvcmllbnRhdGlvbjogXCJ2ZXJ0aWNhbFwiLFxyXG4gICAgICAvLyBzdGVwOiAxNSxcclxuICAgICAgcmFuZ2U6IHRydWUsXHJcbiAgICAgIG1pbjogcHJpY2VTdGFydCxcclxuICAgICAgbWF4OiBwcmljZUVuZCxcclxuICAgICAgdmFsdWVzOiBbIHByaWNlU3RhcnQsIHByaWNlRW5kIF0sXHJcbiAgICAgIHNsaWRlOiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xyXG4gICAgICAgICQoIFwiI2Ftb3VudF9zdGFydFwiICkudmFsKCB1aS52YWx1ZXNbIDAgXSApO1xyXG4gICAgICAgICQoIFwiI2Ftb3VudF9lbmRcIiApLnZhbCggdWkudmFsdWVzWyAxIF0gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAkKCBcIiNhbW91bnRfc3RhcnRcIiApLnZhbCggJCggXCIjZm9ybS1zbGlkZXItdWlcIiApLnNsaWRlciggXCJ2YWx1ZXNcIiwgMCApICk7XHJcbiAgICAkKCBcIiNhbW91bnRfZW5kXCIgKS52YWwoICQoIFwiI2Zvcm0tc2xpZGVyLXVpXCIgKS5zbGlkZXIoIFwidmFsdWVzXCIsIDEgKSApO1xyXG5cclxuICAgIC8vINCY0LfQvNC10L3QtdC90LjQtSDQvNC10YHRgtC+0L/QvtC70L7QttC10L3QuNGPINC/0L7Qu9C30YPQvdC60LAg0L/RgNC4INCy0LLQvtC00LjQtNC1INC00LDQvdC90YvRhSDQsiDQv9C10YDQstGL0Lkg0Y3Qu9C10LzQtdC90YIgaW5wdXRcclxuICAgICQoXCJpbnB1dCNhbW91bnRcIikuY2hhbmdlKGZ1bmN0aW9uKCl7XHJcbiAgICAgIHZhciB2YWx1ZTE9JChcImlucHV0I2Ftb3VudF9zdGFydFwiKS52YWwoKTtcclxuICAgICAgdmFyIHZhbHVlMj0kKFwiaW5wdXQjYW1vdW50XzFcIikudmFsKCk7XHJcbiAgICAgICAgaWYocGFyc2VJbnQodmFsdWUxKSA+IHBhcnNlSW50KHZhbHVlMikpe1xyXG4gICAgICAgIHZhbHVlMSA9IHZhbHVlMjtcclxuICAgICAgICAkKFwiaW5wdXQjYW1vdW50X3N0YXJ0XCIpLnZhbCh2YWx1ZTEpO1xyXG4gICAgICB9XHJcbiAgICAgICQoXCIjZm9ybS1zbGlkZXItdWlcIikuc2xpZGVyKFwidmFsdWVzXCIsMCx2YWx1ZTEpOyBcclxuICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgLy8g0JjQt9C80LXQvdC10L3QuNC1INC80LXRgdGC0L7Qv9C+0LvQvtC20LXQvdC40Y8g0L/QvtC70LfRg9C90LrQsCDQv9GA0Lgg0LLQstC+0LTQuNC00LUg0LTQsNC90L3Ri9GFINCyINCy0YLQvtGA0L7QuSDRjdC70LXQvNC10L3RgiBpbnB1dCAgXHJcbiAgICAkKFwiaW5wdXQjYW1vdW50XzFcIikuY2hhbmdlKGZ1bmN0aW9uKCl7XHJcbiAgICAgIHZhciB2YWx1ZTE9JChcImlucHV0I2Ftb3VudF9zdGFydFwiKS52YWwoKTtcclxuICAgICAgdmFyIHZhbHVlMj0kKFwiaW5wdXQjYW1vdW50X2VuZFwiKS52YWwoKTtcclxuXHJcbiAgICAgIGlmKHBhcnNlSW50KHZhbHVlMSkgPiBwYXJzZUludCh2YWx1ZTIpKXtcclxuICAgICAgICB2YWx1ZTIgPSB2YWx1ZTE7XHJcbiAgICAgICAgJChcImlucHV0I2Ftb3VudF9lbmRcIikudmFsKHZhbHVlMik7XHJcbiAgICAgIH1cclxuICAgICAgJChcIiNmb3JtLXNsaWRlci11aVwiKS5zbGlkZXIoXCJ2YWx1ZXNcIiwxLHZhbHVlMik7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDRhNC40LvRjNGC0YDQsNGG0LjRjyDQstCy0L7QtNCwINCyINC/0L7Qu9GPXHJcbiAgICBqUXVlcnkoJyNhbW91bnRfc3RhcnQsICNhbW91bnRfZW5kJykua2V5cHJlc3MoZnVuY3Rpb24oZXZlbnQpe1xyXG4gICAgICB2YXIga2V5LCBrZXlDaGFyO1xyXG4gICAgICBpZighZXZlbnQpIHZhciBldmVudCA9IHdpbmRvdy5ldmVudDtcclxuICAgICAgXHJcbiAgICAgIGlmIChldmVudC5rZXlDb2RlKSBrZXkgPSBldmVudC5rZXlDb2RlO1xyXG4gICAgICBlbHNlIGlmKGV2ZW50LndoaWNoKSBrZXkgPSBldmVudC53aGljaDtcclxuICAgIFxyXG4gICAgICBpZihrZXk9PW51bGwgfHwga2V5PT0wIHx8IGtleT09OCB8fCBrZXk9PTEzIHx8IGtleT09OSB8fCBrZXk9PTQ2IHx8IGtleT09MzcgfHwga2V5PT0zOSApIHJldHVybiB0cnVlO1xyXG4gICAgICBrZXlDaGFyPVN0cmluZy5mcm9tQ2hhckNvZGUoa2V5KTtcclxuICAgICAgXHJcbiAgICAgIGlmKCEvXFxkLy50ZXN0KGtleUNoYXIpKSByZXR1cm4gZmFsc2U7XHJcbiAgICBcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIHNsaWRlckZvcm0oJy5mb3JtX19jb3N0LS1zdGFydCcsICcuZm9ybV9fY29zdC0tZW5kJyk7XHJcbiAgc2xpZGVyRm9ybSgnLnByb2plY3RzLWZpbHRlcl9fY29zdC0tc3RhcnQnLCAnLnByb2plY3RzLWZpbHRlcl9fY29zdC0tZW5kJylcclxuXHJcblxyXG4gIC8vINCX0LDQutGA0YvRgtC40LUg0LTRgNC+0L/QtNCw0YPQvdC+0LIg0L/QviDQutC70LjQutGDINCy0L3QtSDQuNGFXHJcbiAgLy8gXHJcbiAgZnVuY3Rpb24gY2xvc2VPdXREcm9wZG93bihkcm9wRG93biwgaW5wdXQpIHtcclxuXHJcbiAgICAkKGRvY3VtZW50KS5tb3VzZXVwKGZ1bmN0aW9uIChlKXsgLy8g0YHQvtCx0YvRgtC40LUg0LrQu9C40LrQsCDQv9C+INCy0LXQsS3QtNC+0LrRg9C80LXQvdGC0YNcclxuICAgICAgdmFyIGRyb3AgPSAkKGRyb3BEb3duKTsgLy8g0YLRg9GCINGD0LrQsNC30YvQstCw0LXQvCBJRCDRjdC70LXQvNC10L3RgtCwXHJcbiAgICAgIHZhciBpbnAgPSAkKGlucHV0KTtcclxuICAgICAgaWYgKGlucC5pcyhlLnRhcmdldCkpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH0gZWxzZSBpZiAoIWRyb3AuaXMoZS50YXJnZXQpIC8vINC10YHQu9C4INC60LvQuNC6INCx0YvQuyDQvdC1INC/0L4g0L3QsNGI0LXQvNGDINCx0LvQvtC60YNcclxuICAgICAgICAgICYmIGRyb3AuaGFzKGUudGFyZ2V0KS5sZW5ndGggPT09IDApIHsgLy8g0Lgg0L3QtSDQv9C+INC10LPQviDQtNC+0YfQtdGA0L3QuNC8INGN0LvQtdC80LXQvdGC0LDQvFxyXG4gICAgICAgIGRyb3AuaGlkZSgpOyAvLyDRgdC60YDRi9Cy0LDQtdC8INC10LPQvlxyXG4gICAgICB9IFxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgY2xvc2VPdXREcm9wZG93bignLmZvcm1fX2Ryb3Bkb3duJywgJy5mb3JtX19zZWxlY3RlZCcpO1xyXG4gIGNsb3NlT3V0RHJvcGRvd24oJy5wcm9qZWN0cy1maWx0ZXJfX2Ryb3Bkb3duJywgJy5wcm9qZWN0cy1maWx0ZXJfX3NlbGVjdGVkJyk7XHJcbiAgY2xvc2VPdXREcm9wZG93bignLmZvcm0tcmV2aWV3X19kcm9wZG93bicsICcuZm9ybS1yZXZpZXdfX3NlbGVjdGVkJyk7XHJcblxyXG4gIGZ1bmN0aW9uIGNsaWNrU2VsZWN0KHNlbGVjdCwgZHJvcExpc3Qpe1xyXG5cclxuICAgICQoc2VsZWN0KS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgIFxyXG4gICAgICB2YXIgZHJvcERvd24gPSAkKHRoaXMpLmZpbmQoZHJvcExpc3QpO1xyXG4gICAgICB2YXIgZXZlckRyb3BEb3duID0gJChkcm9wTGlzdCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIGRyb3BEb3duLmlzKCc6dmlzaWJsZScpICkge1xyXG4gICAgICAgIGV2ZXJEcm9wRG93bi5oaWRlKCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoIGRyb3BEb3duLmlzKCc6aGlkZGVuJykgKSB7XHJcbiAgICAgICAgZXZlckRyb3BEb3duLmhpZGUoKTtcclxuICAgICAgICBkcm9wRG93bi5zaG93KCk7XHJcbiAgICAgIH0gXHJcbiAgICAgIFxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgY2xpY2tTZWxlY3QoJy5mb3JtX19zZWxlY3QnLCAnLmZvcm1fX2Ryb3Bkb3duJyk7XHJcbiAgY2xpY2tTZWxlY3QoJy5wcm9qZWN0cy1maWx0ZXJfX3NlbGVjdCcsICcucHJvamVjdHMtZmlsdGVyX19kcm9wZG93bicpO1xyXG4gIGNsaWNrU2VsZWN0KCcuZm9ybS1yZXZpZXdfX3NlbGVjdCcsICcuZm9ybS1yZXZpZXdfX2Ryb3Bkb3duJyk7XHJcblxyXG4gIFxyXG5cclxuXHJcbiAgLy8g0JfQsNC60YDRi9GC0LjQtSDQtNGA0L7Qv9GC0LDQtNGD0L3QvtCyINC/0L4g0LrQu9C40LrRgyDQvdCwINC00YDRg9Cz0L7QuSDRgdC10LvQtdC60YJcclxuICAvLyBcclxuICAvLyBcclxuICAvLyBcclxuICAkKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgdmFyIGRhdGVFbmQgPSAkKCcjY291bnRkb3duLXByb21vJykuZGF0YSgndGltZXItaG91cnMnKTtcclxuICBcclxuICAgIHZhciBub3RlID0gJCgnI25vdGUnKSxcclxuICAgICAgdHMgPSBuZXcgRGF0ZSgyMDEyLCAwLCAxKSxcclxuICAgICAgbmV3WWVhciA9IHRydWU7XHJcbiAgICBcclxuICAgIGlmKChuZXcgRGF0ZSgpKSA+IHRzKXtcclxuICAgICAgLy8gVGhlIG5ldyB5ZWFyIGlzIGhlcmUhIENvdW50IHRvd2FyZHMgc29tZXRoaW5nIGVsc2UuXHJcbiAgICAgIC8vIE5vdGljZSB0aGUgKjEwMDAgYXQgdGhlIGVuZCAtIHRpbWUgbXVzdCBiZSBpbiBtaWxsaXNlY29uZHNcclxuICAgICAgdHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpICsgZGF0ZUVuZCoyNCo2MCo2MCoxMDAwO1xyXG4gICAgICBuZXdZZWFyID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG5cclxuICAgICAgXHJcbiAgICAkKCcjY291bnRkb3duLXByb21vJykuY291bnRkb3duKHtcclxuICAgICAgdGltZXN0YW1wIDogdHMsXHJcbiAgICAgIGNhbGxiYWNrICA6IGZ1bmN0aW9uKGRheXMsIGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKXtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgbWVzc2FnZSA9IFwiXCI7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbWVzc2FnZSArPSBkYXlzICsgXCIgZGF5XCIgKyAoIGRheXM9PTEgPyAnJzoncycgKSArIFwiLCBcIjtcclxuICAgICAgICBtZXNzYWdlICs9IGhvdXJzICsgXCIgaG91clwiICsgKCBob3Vycz09MSA/ICcnOidzJyApICsgXCIsIFwiO1xyXG4gICAgICAgIG1lc3NhZ2UgKz0gbWludXRlcyArIFwiIG1pbnV0ZVwiICsgKCBtaW51dGVzPT0xID8gJyc6J3MnICkgKyBcIiBhbmQgXCI7XHJcbiAgICAgICAgbWVzc2FnZSArPSBzZWNvbmRzICsgXCIgc2Vjb25kXCIgKyAoIHNlY29uZHM9PTEgPyAnJzoncycgKSArIFwiIDxiciAvPlwiO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmKG5ld1llYXIpe1xyXG4gICAgICAgICAgbWVzc2FnZSArPSBcImxlZnQgdW50aWwgdGhlIG5ldyB5ZWFyIVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIG1lc3NhZ2UgKz0gXCJsZWZ0IHRvIDEwIGRheXMgZnJvbSBub3chXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIG5vdGUuaHRtbChtZXNzYWdlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICB9KTtcclxuXHJcblxyXG59KTsiXX0=
