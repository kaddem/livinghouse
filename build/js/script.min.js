$(document).ready(function(){

  console.log('yep, jQuery work!');
  $('.promo-slider').slick({
    dots: true
    // autoplay: true,
    // autoplaySpeed: 500
  });

  // $('.review__slider-preview-item')
  // 

  $('.review__slider-big').slick({
    slidesToShow: 1,
    slidesToScroll: 1,
    arrows: false,
    fade: true,
    asNavFor: '.review__slider-preview'
  });

  $('.review__slider-preview').slick({
    slidesToShow: 4,
    slidesToScroll: 1,
    asNavFor: '.review__slider-big',
    dots: false,
    centerMode: false,
    focusOnSelect: true,
    responsive: [
      {
        breakpoint: 1200,
        settings: {
          slidesToShow: 2
        }
      }
      // },
      // {
      //   breakpoint: 768,
      //   settings: {
      //     slidesToShow: 0,
      //     settings: "unslick"
      //   }
      // }
      // You can unslick at a given breakpoint now by adding:
      // settings: "unslick"
      // instead of a settings object
    ]
  });

});

$(window).load(function () {
  function ratioPhoto(block) {
    $(block).each(function(){
      var itemWidth = $(this).width();
      var itemHeight = $(this).height();
      var itemRatio = itemHeight / itemWidth;

      var photo = $(this).find('img');
      var photoWidth = photo.width();
      var photoHeight = photo.height();
      var photoRatio = photoHeight / photoWidth;

      if ( itemRatio < photoRatio ) {
        photo.width('100%');
        photo.height('auto');
      } else if (itemRatio > photoRatio) {
        photo.height('100%');
        photo.width('auto');
      } else {
        photo.width('100%');
        photo.height('auto');
      }
    });
  }

  function ratioLetter(block) {
    $(block).each(function(){
      var itemWidth = $(this).width();
      var itemHeight = $(this).height();
      var itemRatio = itemHeight / itemWidth;

      var photo = $(this).find('img');
      var photoWidth = photo.width();
      var photoHeight = photo.height();
      var photoRatio = photoHeight / photoWidth;

      if ( itemRatio > photoRatio ) {
        photo.width('100%');
      } else if (itemRatio < photoRatio) {
        photo.height('100%');
      } else {
        photo.width('100%');
      }
    });
  }

  ratioPhoto('.review__slider-preview-item');
  ratioPhoto('.review__slider-big-item');
  ratioLetter('.review__letter-box');
  ratioLetter('.review__chart-box');
  ratioPhoto('.gallery__item');
  ratioPhoto('.project-card__photo');
  ratioPhoto('.review-card__visual');
  ratioPhoto('.project__photo');

  $(window).resize(function(){
    ratioPhoto('.review__slider-preview-item');
    ratioPhoto('.review__slider-big-item');
    ratioLetter('.review__letter-box');
    ratioLetter('.review__chart-box');
    ratioPhoto('.gallery__item');
    ratioPhoto('.project-card__photo');
    ratioPhoto('.review-card__visual');
    ratioPhoto('.project__photo');
  });

  function tabs(boxTabsLink, boxTabsContent, tabs){ 
    $(boxTabsLink + ' input').on('click', function(e){
      var attrLink = $(this).attr('id');
      console.log(attrLink);
      $(boxTabsContent + ' ' + tabs).css("display", "none");
      $(boxTabsContent + ' .' + attrLink).css("display", "block");
    }); 
  };


  tabs('#tabs-roof', '#tabs-roof-content', '.project-form__table-select--roof-content');
  tabs('#tabs-frame', '#tabs-frame-content', '.project-form__tab-item');



  // бургер, что тут еще скажешь? но без колы(
  $('.burger').on('click', function(e){
      e.preventDefault();
      if ( $(this).hasClass("burger--close") ) {
          $(this).removeClass('burger--close');
          $('.main-nav').slideUp(400);
          $('.main-nav').removeClass('main-nav--open');
          $('.page-header').removeClass('page-header--open');
      } else {
          $(this).addClass('burger--close');
          $('.main-nav').slideDown(400);
          $('.main-nav').addClass('main-nav--open');
          $('.page-header').addClass('page-header--open');
      }
  });

  $('.nav ul a').on('click', function(e){
      if ($(window).width() < 768) {
          $('.main-nav').slideUp(400);
          $('.burger').addClass('burger--open');
          $('.burger').removeClass('burger--close');
      };
  });


  $(window).resize(function(){
      if( $(window).width() > 767 ) {
          $('.main-nav').show();
      } else {
          $('.main-nav').slideUp(400);
          $('.main-nav').removeClass('main-nav--open');
          $('.page-header').removeClass('page-header--open');
          $('.burger').removeClass('burger--close');
      }
  });

  $(window).on('scroll', function(e) { // отслеживаем событие на элементе window
    if( $(window).width() < 768 ) {
        $('.main-nav').slideUp(400);
        $('.main-nav').removeClass('main-nav--open');
        $('.page-header').removeClass('page-header--open');
        $('.burger').removeClass('burger--close');
    }
  });

  if ( $(window).scrollTop() > 100 && $(window).width() > 767) {
    $('.page-header').addClass('page-header--scroll');
    $('.page-header').addClass('page-header--desktop');
  } else if ( $(window).scrollTop() > 100 ) {
    $('.page-header').addClass('page-header--scroll');
  }

  $(window).on('scroll', function(e) {

    if ( $(window).scrollTop() > 100 && $(window).width() > 1199 ) {
      $('.page-header').addClass('page-header--scroll');
      $('.page-header').addClass('page-header--desktop');
    } else if ( $(window).scrollTop() > 100 ) {
      $('.page-header').addClass('page-header--scroll');
      $('.page-header').removeClass('page-header--desktop');
    } else {
      $('.page-header').removeClass('page-header--scroll');
      $('.page-header').removeClass('page-header--desktop');
    }

  });

  function telMask(selector) {
    $(selector).mask('+7 (000) 000-00-00');
  }

  telMask('.contact-form__input--tel');
  telMask('.consult__input-tel');

  // Ползунок для форм
  
  function sliderForm( inputStart, inputEnd, idSlider, dataStart, dataEnd ) {
    var priceStart = $(inputStart).data( dataStart );
    console.log(priceStart);
    var priceEnd = $(inputEnd).data( dataEnd );
    console.log(priceEnd);

    $( idSlider ).slider({
      // orientation: "vertical",
      // step: 15,
      range: true,
      min: priceStart,
      max: priceEnd,
      values: [ priceStart, priceEnd ],
      slide: function( event, ui ) {
        $( inputStart ).val( ui.values[ 0 ] );
        $( inputEnd ).val( ui.values[ 1 ] );
      }
    });
    $( inputStart ).val( $( idSlider ).slider( "values", 0 ) );
    $( inputEnd ).val( $( idSlider ).slider( "values", 1 ) );

    // Изменение местоположения ползунка при вводиде данных в первый элемент input
    $( inputStart ).change(function(){
      var value1=$( inputStart ).val();
      var value2=$( inputEnd ).val();

      if (parseInt(value1) > parseInt(value2)){
        value1 = value2;
        $( inputStart ).val(value1);
      }
      $(idSlider).slider("values",0,value1); 
    });
        
    // Изменение местоположения ползунка при вводиде данных в второй элемент input  
    $( inputEnd ).change(function(){
      var value1=$( inputStart ).val();
      var value2=$( inputEnd ).val();

      if(parseInt(value1) > parseInt(value2)){
        value2 = value1;
        $( inputEnd ).val(value2);
      }
      $(idSlider).slider("values",1,value2);
    });

    // фильтрация ввода в поля
    jQuery('#amount_start, #amount_end').keypress(function(event){
      var key, keyChar;
      if(!event) var event = window.event;
      
      if (event.keyCode) key = event.keyCode;
      else if(event.which) key = event.which;
    
      if(key==null || key==0 || key==8 || key==13 || key==9 || key==46 || key==37 || key==39 ) return true;
      keyChar=String.fromCharCode(key);
      
      if(!/\d/.test(keyChar)) return false;
    
    });

  }

  sliderForm('.projects-filter__cost--start', '.projects-filter__cost--end', '#project-slider-ui', 'proj-start', 'proj-end');
  sliderForm('.form__cost--start', '.form__cost--end', '#form-slider-ui', 'price-start', 'price-end');

  // Закрытие дропдаунов по клику вне их
  // 
  function closeOutDropdown(dropDown, input) {

    $(document).mouseup(function (e){ // событие клика по веб-документу
      var drop = $(dropDown); // тут указываем ID элемента
      var inp = $(input);
      if (inp.is(e.target)) {
        return;
      } else if (!drop.is(e.target) // если клик был не по нашему блоку
          && drop.has(e.target).length === 0) { // и не по его дочерним элементам
        drop.hide(); // скрываем его
      } 
    });

  }

  closeOutDropdown('.form__dropdown', '.form__selected');
  closeOutDropdown('.projects-filter__dropdown', '.projects-filter__selected');
  closeOutDropdown('.form-review__dropdown', '.form-review__selected');

  function clickSelect(select, dropList){

    $(select).on('click', function(e){
    
      var dropDown = $(this).find(dropList);
      var everDropDown = $(dropList);
      
      if ( dropDown.is(':visible') ) {
        everDropDown.hide();
      } else if ( dropDown.is(':hidden') ) {
        everDropDown.hide();
        dropDown.show();
      } 
      
    });

  }

  clickSelect('.form__select', '.form__dropdown');
  clickSelect('.projects-filter__select', '.projects-filter__dropdown');
  clickSelect('.form-review__select', '.form-review__dropdown');

  


  // Закрытие дроптадунов по клику на другой селект
  // 
  // 
  // 
  $(function(){

    var dateEnd = $('#countdown-promo').data('timer-hours');
  
    var note = $('#note'),
      ts = new Date(2012, 0, 1),
      newYear = true;
    
    if((new Date()) > ts){
      // The new year is here! Count towards something else.
      // Notice the *1000 at the end - time must be in milliseconds
      ts = (new Date()).getTime() + dateEnd*24*60*60*1000;
      newYear = false;
    }


      
    $('#countdown-promo').countdown({
      timestamp : ts,
      callback  : function(days, hours, minutes, seconds){
        
        var message = "";
        
        message += days + " day" + ( days==1 ? '':'s' ) + ", ";
        message += hours + " hour" + ( hours==1 ? '':'s' ) + ", ";
        message += minutes + " minute" + ( minutes==1 ? '':'s' ) + " and ";
        message += seconds + " second" + ( seconds==1 ? '':'s' ) + " <br />";
        
        if(newYear){
          message += "left until the new year!";
        }
        else {
          message += "left to 10 days from now!";
        }
        
        note.html(message);
      }
    });
    
  });


});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe1xyXG5cclxuICBjb25zb2xlLmxvZygneWVwLCBqUXVlcnkgd29yayEnKTtcclxuICAkKCcucHJvbW8tc2xpZGVyJykuc2xpY2soe1xyXG4gICAgZG90czogdHJ1ZVxyXG4gICAgLy8gYXV0b3BsYXk6IHRydWUsXHJcbiAgICAvLyBhdXRvcGxheVNwZWVkOiA1MDBcclxuICB9KTtcclxuXHJcbiAgLy8gJCgnLnJldmlld19fc2xpZGVyLXByZXZpZXctaXRlbScpXHJcbiAgLy8gXHJcblxyXG4gICQoJy5yZXZpZXdfX3NsaWRlci1iaWcnKS5zbGljayh7XHJcbiAgICBzbGlkZXNUb1Nob3c6IDEsXHJcbiAgICBzbGlkZXNUb1Njcm9sbDogMSxcclxuICAgIGFycm93czogZmFsc2UsXHJcbiAgICBmYWRlOiB0cnVlLFxyXG4gICAgYXNOYXZGb3I6ICcucmV2aWV3X19zbGlkZXItcHJldmlldydcclxuICB9KTtcclxuXHJcbiAgJCgnLnJldmlld19fc2xpZGVyLXByZXZpZXcnKS5zbGljayh7XHJcbiAgICBzbGlkZXNUb1Nob3c6IDQsXHJcbiAgICBzbGlkZXNUb1Njcm9sbDogMSxcclxuICAgIGFzTmF2Rm9yOiAnLnJldmlld19fc2xpZGVyLWJpZycsXHJcbiAgICBkb3RzOiBmYWxzZSxcclxuICAgIGNlbnRlck1vZGU6IGZhbHNlLFxyXG4gICAgZm9jdXNPblNlbGVjdDogdHJ1ZSxcclxuICAgIHJlc3BvbnNpdmU6IFtcclxuICAgICAge1xyXG4gICAgICAgIGJyZWFrcG9pbnQ6IDEyMDAsXHJcbiAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgIHNsaWRlc1RvU2hvdzogMlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvLyB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgYnJlYWtwb2ludDogNzY4LFxyXG4gICAgICAvLyAgIHNldHRpbmdzOiB7XHJcbiAgICAgIC8vICAgICBzbGlkZXNUb1Nob3c6IDAsXHJcbiAgICAgIC8vICAgICBzZXR0aW5nczogXCJ1bnNsaWNrXCJcclxuICAgICAgLy8gICB9XHJcbiAgICAgIC8vIH1cclxuICAgICAgLy8gWW91IGNhbiB1bnNsaWNrIGF0IGEgZ2l2ZW4gYnJlYWtwb2ludCBub3cgYnkgYWRkaW5nOlxyXG4gICAgICAvLyBzZXR0aW5nczogXCJ1bnNsaWNrXCJcclxuICAgICAgLy8gaW5zdGVhZCBvZiBhIHNldHRpbmdzIG9iamVjdFxyXG4gICAgXVxyXG4gIH0pO1xyXG5cclxufSk7XHJcblxyXG4kKHdpbmRvdykubG9hZChmdW5jdGlvbiAoKSB7XHJcbiAgZnVuY3Rpb24gcmF0aW9QaG90byhibG9jaykge1xyXG4gICAgJChibG9jaykuZWFjaChmdW5jdGlvbigpe1xyXG4gICAgICB2YXIgaXRlbVdpZHRoID0gJCh0aGlzKS53aWR0aCgpO1xyXG4gICAgICB2YXIgaXRlbUhlaWdodCA9ICQodGhpcykuaGVpZ2h0KCk7XHJcbiAgICAgIHZhciBpdGVtUmF0aW8gPSBpdGVtSGVpZ2h0IC8gaXRlbVdpZHRoO1xyXG5cclxuICAgICAgdmFyIHBob3RvID0gJCh0aGlzKS5maW5kKCdpbWcnKTtcclxuICAgICAgdmFyIHBob3RvV2lkdGggPSBwaG90by53aWR0aCgpO1xyXG4gICAgICB2YXIgcGhvdG9IZWlnaHQgPSBwaG90by5oZWlnaHQoKTtcclxuICAgICAgdmFyIHBob3RvUmF0aW8gPSBwaG90b0hlaWdodCAvIHBob3RvV2lkdGg7XHJcblxyXG4gICAgICBpZiAoIGl0ZW1SYXRpbyA8IHBob3RvUmF0aW8gKSB7XHJcbiAgICAgICAgcGhvdG8ud2lkdGgoJzEwMCUnKTtcclxuICAgICAgICBwaG90by5oZWlnaHQoJ2F1dG8nKTtcclxuICAgICAgfSBlbHNlIGlmIChpdGVtUmF0aW8gPiBwaG90b1JhdGlvKSB7XHJcbiAgICAgICAgcGhvdG8uaGVpZ2h0KCcxMDAlJyk7XHJcbiAgICAgICAgcGhvdG8ud2lkdGgoJ2F1dG8nKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBwaG90by53aWR0aCgnMTAwJScpO1xyXG4gICAgICAgIHBob3RvLmhlaWdodCgnYXV0bycpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJhdGlvTGV0dGVyKGJsb2NrKSB7XHJcbiAgICAkKGJsb2NrKS5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgIHZhciBpdGVtV2lkdGggPSAkKHRoaXMpLndpZHRoKCk7XHJcbiAgICAgIHZhciBpdGVtSGVpZ2h0ID0gJCh0aGlzKS5oZWlnaHQoKTtcclxuICAgICAgdmFyIGl0ZW1SYXRpbyA9IGl0ZW1IZWlnaHQgLyBpdGVtV2lkdGg7XHJcblxyXG4gICAgICB2YXIgcGhvdG8gPSAkKHRoaXMpLmZpbmQoJ2ltZycpO1xyXG4gICAgICB2YXIgcGhvdG9XaWR0aCA9IHBob3RvLndpZHRoKCk7XHJcbiAgICAgIHZhciBwaG90b0hlaWdodCA9IHBob3RvLmhlaWdodCgpO1xyXG4gICAgICB2YXIgcGhvdG9SYXRpbyA9IHBob3RvSGVpZ2h0IC8gcGhvdG9XaWR0aDtcclxuXHJcbiAgICAgIGlmICggaXRlbVJhdGlvID4gcGhvdG9SYXRpbyApIHtcclxuICAgICAgICBwaG90by53aWR0aCgnMTAwJScpO1xyXG4gICAgICB9IGVsc2UgaWYgKGl0ZW1SYXRpbyA8IHBob3RvUmF0aW8pIHtcclxuICAgICAgICBwaG90by5oZWlnaHQoJzEwMCUnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBwaG90by53aWR0aCgnMTAwJScpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJhdGlvUGhvdG8oJy5yZXZpZXdfX3NsaWRlci1wcmV2aWV3LWl0ZW0nKTtcclxuICByYXRpb1Bob3RvKCcucmV2aWV3X19zbGlkZXItYmlnLWl0ZW0nKTtcclxuICByYXRpb0xldHRlcignLnJldmlld19fbGV0dGVyLWJveCcpO1xyXG4gIHJhdGlvTGV0dGVyKCcucmV2aWV3X19jaGFydC1ib3gnKTtcclxuICByYXRpb1Bob3RvKCcuZ2FsbGVyeV9faXRlbScpO1xyXG4gIHJhdGlvUGhvdG8oJy5wcm9qZWN0LWNhcmRfX3Bob3RvJyk7XHJcbiAgcmF0aW9QaG90bygnLnJldmlldy1jYXJkX192aXN1YWwnKTtcclxuICByYXRpb1Bob3RvKCcucHJvamVjdF9fcGhvdG8nKTtcclxuXHJcbiAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpe1xyXG4gICAgcmF0aW9QaG90bygnLnJldmlld19fc2xpZGVyLXByZXZpZXctaXRlbScpO1xyXG4gICAgcmF0aW9QaG90bygnLnJldmlld19fc2xpZGVyLWJpZy1pdGVtJyk7XHJcbiAgICByYXRpb0xldHRlcignLnJldmlld19fbGV0dGVyLWJveCcpO1xyXG4gICAgcmF0aW9MZXR0ZXIoJy5yZXZpZXdfX2NoYXJ0LWJveCcpO1xyXG4gICAgcmF0aW9QaG90bygnLmdhbGxlcnlfX2l0ZW0nKTtcclxuICAgIHJhdGlvUGhvdG8oJy5wcm9qZWN0LWNhcmRfX3Bob3RvJyk7XHJcbiAgICByYXRpb1Bob3RvKCcucmV2aWV3LWNhcmRfX3Zpc3VhbCcpO1xyXG4gICAgcmF0aW9QaG90bygnLnByb2plY3RfX3Bob3RvJyk7XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIHRhYnMoYm94VGFic0xpbmssIGJveFRhYnNDb250ZW50LCB0YWJzKXsgXHJcbiAgICAkKGJveFRhYnNMaW5rICsgJyBpbnB1dCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICB2YXIgYXR0ckxpbmsgPSAkKHRoaXMpLmF0dHIoJ2lkJyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGF0dHJMaW5rKTtcclxuICAgICAgJChib3hUYWJzQ29udGVudCArICcgJyArIHRhYnMpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xyXG4gICAgICAkKGJveFRhYnNDb250ZW50ICsgJyAuJyArIGF0dHJMaW5rKS5jc3MoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIik7XHJcbiAgICB9KTsgXHJcbiAgfTtcclxuXHJcblxyXG4gIHRhYnMoJyN0YWJzLXJvb2YnLCAnI3RhYnMtcm9vZi1jb250ZW50JywgJy5wcm9qZWN0LWZvcm1fX3RhYmxlLXNlbGVjdC0tcm9vZi1jb250ZW50Jyk7XHJcbiAgdGFicygnI3RhYnMtZnJhbWUnLCAnI3RhYnMtZnJhbWUtY29udGVudCcsICcucHJvamVjdC1mb3JtX190YWItaXRlbScpO1xyXG5cclxuXHJcblxyXG4gIC8vINCx0YPRgNCz0LXRgCwg0YfRgtC+INGC0YPRgiDQtdGJ0LUg0YHQutCw0LbQtdGI0Yw/INC90L4g0LHQtdC3INC60L7Qu9GLKFxyXG4gICQoJy5idXJnZXInKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBpZiAoICQodGhpcykuaGFzQ2xhc3MoXCJidXJnZXItLWNsb3NlXCIpICkge1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYnVyZ2VyLS1jbG9zZScpO1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2Jykuc2xpZGVVcCg0MDApO1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2JykucmVtb3ZlQ2xhc3MoJ21haW4tbmF2LS1vcGVuJyk7XHJcbiAgICAgICAgICAkKCcucGFnZS1oZWFkZXInKS5yZW1vdmVDbGFzcygncGFnZS1oZWFkZXItLW9wZW4nKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2J1cmdlci0tY2xvc2UnKTtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnNsaWRlRG93big0MDApO1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2JykuYWRkQ2xhc3MoJ21haW4tbmF2LS1vcGVuJyk7XHJcbiAgICAgICAgICAkKCcucGFnZS1oZWFkZXInKS5hZGRDbGFzcygncGFnZS1oZWFkZXItLW9wZW4nKTtcclxuICAgICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKCcubmF2IHVsIGEnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNzY4KSB7XHJcbiAgICAgICAgICAkKCcubWFpbi1uYXYnKS5zbGlkZVVwKDQwMCk7XHJcbiAgICAgICAgICAkKCcuYnVyZ2VyJykuYWRkQ2xhc3MoJ2J1cmdlci0tb3BlbicpO1xyXG4gICAgICAgICAgJCgnLmJ1cmdlcicpLnJlbW92ZUNsYXNzKCdidXJnZXItLWNsb3NlJyk7XHJcbiAgICAgIH07XHJcbiAgfSk7XHJcblxyXG5cclxuICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCl7XHJcbiAgICAgIGlmKCAkKHdpbmRvdykud2lkdGgoKSA+IDc2NyApIHtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnNob3coKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnNsaWRlVXAoNDAwKTtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnJlbW92ZUNsYXNzKCdtYWluLW5hdi0tb3BlbicpO1xyXG4gICAgICAgICAgJCgnLnBhZ2UtaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1vcGVuJyk7XHJcbiAgICAgICAgICAkKCcuYnVyZ2VyJykucmVtb3ZlQ2xhc3MoJ2J1cmdlci0tY2xvc2UnKTtcclxuICAgICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKHdpbmRvdykub24oJ3Njcm9sbCcsIGZ1bmN0aW9uKGUpIHsgLy8g0L7RgtGB0LvQtdC20LjQstCw0LXQvCDRgdC+0LHRi9GC0LjQtSDQvdCwINGN0LvQtdC80LXQvdGC0LUgd2luZG93XHJcbiAgICBpZiggJCh3aW5kb3cpLndpZHRoKCkgPCA3NjggKSB7XHJcbiAgICAgICAgJCgnLm1haW4tbmF2Jykuc2xpZGVVcCg0MDApO1xyXG4gICAgICAgICQoJy5tYWluLW5hdicpLnJlbW92ZUNsYXNzKCdtYWluLW5hdi0tb3BlbicpO1xyXG4gICAgICAgICQoJy5wYWdlLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdwYWdlLWhlYWRlci0tb3BlbicpO1xyXG4gICAgICAgICQoJy5idXJnZXInKS5yZW1vdmVDbGFzcygnYnVyZ2VyLS1jbG9zZScpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBpZiAoICQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwMCAmJiAkKHdpbmRvdykud2lkdGgoKSA+IDc2Nykge1xyXG4gICAgJCgnLnBhZ2UtaGVhZGVyJykuYWRkQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1zY3JvbGwnKTtcclxuICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tZGVza3RvcCcpO1xyXG4gIH0gZWxzZSBpZiAoICQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwMCApIHtcclxuICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tc2Nyb2xsJyk7XHJcbiAgfVxyXG5cclxuICAkKHdpbmRvdykub24oJ3Njcm9sbCcsIGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICBpZiAoICQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwMCAmJiAkKHdpbmRvdykud2lkdGgoKSA+IDExOTkgKSB7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tc2Nyb2xsJyk7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tZGVza3RvcCcpO1xyXG4gICAgfSBlbHNlIGlmICggJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMTAwICkge1xyXG4gICAgICAkKCcucGFnZS1oZWFkZXInKS5hZGRDbGFzcygncGFnZS1oZWFkZXItLXNjcm9sbCcpO1xyXG4gICAgICAkKCcucGFnZS1oZWFkZXInKS5yZW1vdmVDbGFzcygncGFnZS1oZWFkZXItLWRlc2t0b3AnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdwYWdlLWhlYWRlci0tc2Nyb2xsJyk7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdwYWdlLWhlYWRlci0tZGVza3RvcCcpO1xyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gdGVsTWFzayhzZWxlY3Rvcikge1xyXG4gICAgJChzZWxlY3RvcikubWFzaygnKzcgKDAwMCkgMDAwLTAwLTAwJyk7XHJcbiAgfVxyXG5cclxuICB0ZWxNYXNrKCcuY29udGFjdC1mb3JtX19pbnB1dC0tdGVsJyk7XHJcbiAgdGVsTWFzaygnLmNvbnN1bHRfX2lucHV0LXRlbCcpO1xyXG5cclxuICAvLyDQn9C+0LvQt9GD0L3QvtC6INC00LvRjyDRhNC+0YDQvFxyXG4gIFxyXG4gIGZ1bmN0aW9uIHNsaWRlckZvcm0oIGlucHV0U3RhcnQsIGlucHV0RW5kLCBpZFNsaWRlciwgZGF0YVN0YXJ0LCBkYXRhRW5kICkge1xyXG4gICAgdmFyIHByaWNlU3RhcnQgPSAkKGlucHV0U3RhcnQpLmRhdGEoIGRhdGFTdGFydCApO1xyXG4gICAgY29uc29sZS5sb2cocHJpY2VTdGFydCk7XHJcbiAgICB2YXIgcHJpY2VFbmQgPSAkKGlucHV0RW5kKS5kYXRhKCBkYXRhRW5kICk7XHJcbiAgICBjb25zb2xlLmxvZyhwcmljZUVuZCk7XHJcblxyXG4gICAgJCggaWRTbGlkZXIgKS5zbGlkZXIoe1xyXG4gICAgICAvLyBvcmllbnRhdGlvbjogXCJ2ZXJ0aWNhbFwiLFxyXG4gICAgICAvLyBzdGVwOiAxNSxcclxuICAgICAgcmFuZ2U6IHRydWUsXHJcbiAgICAgIG1pbjogcHJpY2VTdGFydCxcclxuICAgICAgbWF4OiBwcmljZUVuZCxcclxuICAgICAgdmFsdWVzOiBbIHByaWNlU3RhcnQsIHByaWNlRW5kIF0sXHJcbiAgICAgIHNsaWRlOiBmdW5jdGlvbiggZXZlbnQsIHVpICkge1xyXG4gICAgICAgICQoIGlucHV0U3RhcnQgKS52YWwoIHVpLnZhbHVlc1sgMCBdICk7XHJcbiAgICAgICAgJCggaW5wdXRFbmQgKS52YWwoIHVpLnZhbHVlc1sgMSBdICk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgJCggaW5wdXRTdGFydCApLnZhbCggJCggaWRTbGlkZXIgKS5zbGlkZXIoIFwidmFsdWVzXCIsIDAgKSApO1xyXG4gICAgJCggaW5wdXRFbmQgKS52YWwoICQoIGlkU2xpZGVyICkuc2xpZGVyKCBcInZhbHVlc1wiLCAxICkgKTtcclxuXHJcbiAgICAvLyDQmNC30LzQtdC90LXQvdC40LUg0LzQtdGB0YLQvtC/0L7Qu9C+0LbQtdC90LjRjyDQv9C+0LvQt9GD0L3QutCwINC/0YDQuCDQstCy0L7QtNC40LTQtSDQtNCw0L3QvdGL0YUg0LIg0L/QtdGA0LLRi9C5INGN0LvQtdC80LXQvdGCIGlucHV0XHJcbiAgICAkKCBpbnB1dFN0YXJ0ICkuY2hhbmdlKGZ1bmN0aW9uKCl7XHJcbiAgICAgIHZhciB2YWx1ZTE9JCggaW5wdXRTdGFydCApLnZhbCgpO1xyXG4gICAgICB2YXIgdmFsdWUyPSQoIGlucHV0RW5kICkudmFsKCk7XHJcblxyXG4gICAgICBpZiAocGFyc2VJbnQodmFsdWUxKSA+IHBhcnNlSW50KHZhbHVlMikpe1xyXG4gICAgICAgIHZhbHVlMSA9IHZhbHVlMjtcclxuICAgICAgICAkKCBpbnB1dFN0YXJ0ICkudmFsKHZhbHVlMSk7XHJcbiAgICAgIH1cclxuICAgICAgJChpZFNsaWRlcikuc2xpZGVyKFwidmFsdWVzXCIsMCx2YWx1ZTEpOyBcclxuICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgLy8g0JjQt9C80LXQvdC10L3QuNC1INC80LXRgdGC0L7Qv9C+0LvQvtC20LXQvdC40Y8g0L/QvtC70LfRg9C90LrQsCDQv9GA0Lgg0LLQstC+0LTQuNC00LUg0LTQsNC90L3Ri9GFINCyINCy0YLQvtGA0L7QuSDRjdC70LXQvNC10L3RgiBpbnB1dCAgXHJcbiAgICAkKCBpbnB1dEVuZCApLmNoYW5nZShmdW5jdGlvbigpe1xyXG4gICAgICB2YXIgdmFsdWUxPSQoIGlucHV0U3RhcnQgKS52YWwoKTtcclxuICAgICAgdmFyIHZhbHVlMj0kKCBpbnB1dEVuZCApLnZhbCgpO1xyXG5cclxuICAgICAgaWYocGFyc2VJbnQodmFsdWUxKSA+IHBhcnNlSW50KHZhbHVlMikpe1xyXG4gICAgICAgIHZhbHVlMiA9IHZhbHVlMTtcclxuICAgICAgICAkKCBpbnB1dEVuZCApLnZhbCh2YWx1ZTIpO1xyXG4gICAgICB9XHJcbiAgICAgICQoaWRTbGlkZXIpLnNsaWRlcihcInZhbHVlc1wiLDEsdmFsdWUyKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vINGE0LjQu9GM0YLRgNCw0YbQuNGPINCy0LLQvtC00LAg0LIg0L/QvtC70Y9cclxuICAgIGpRdWVyeSgnI2Ftb3VudF9zdGFydCwgI2Ftb3VudF9lbmQnKS5rZXlwcmVzcyhmdW5jdGlvbihldmVudCl7XHJcbiAgICAgIHZhciBrZXksIGtleUNoYXI7XHJcbiAgICAgIGlmKCFldmVudCkgdmFyIGV2ZW50ID0gd2luZG93LmV2ZW50O1xyXG4gICAgICBcclxuICAgICAgaWYgKGV2ZW50LmtleUNvZGUpIGtleSA9IGV2ZW50LmtleUNvZGU7XHJcbiAgICAgIGVsc2UgaWYoZXZlbnQud2hpY2gpIGtleSA9IGV2ZW50LndoaWNoO1xyXG4gICAgXHJcbiAgICAgIGlmKGtleT09bnVsbCB8fCBrZXk9PTAgfHwga2V5PT04IHx8IGtleT09MTMgfHwga2V5PT05IHx8IGtleT09NDYgfHwga2V5PT0zNyB8fCBrZXk9PTM5ICkgcmV0dXJuIHRydWU7XHJcbiAgICAgIGtleUNoYXI9U3RyaW5nLmZyb21DaGFyQ29kZShrZXkpO1xyXG4gICAgICBcclxuICAgICAgaWYoIS9cXGQvLnRlc3Qoa2V5Q2hhcikpIHJldHVybiBmYWxzZTtcclxuICAgIFxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgc2xpZGVyRm9ybSgnLnByb2plY3RzLWZpbHRlcl9fY29zdC0tc3RhcnQnLCAnLnByb2plY3RzLWZpbHRlcl9fY29zdC0tZW5kJywgJyNwcm9qZWN0LXNsaWRlci11aScsICdwcm9qLXN0YXJ0JywgJ3Byb2otZW5kJyk7XHJcbiAgc2xpZGVyRm9ybSgnLmZvcm1fX2Nvc3QtLXN0YXJ0JywgJy5mb3JtX19jb3N0LS1lbmQnLCAnI2Zvcm0tc2xpZGVyLXVpJywgJ3ByaWNlLXN0YXJ0JywgJ3ByaWNlLWVuZCcpO1xyXG5cclxuICAvLyDQl9Cw0LrRgNGL0YLQuNC1INC00YDQvtC/0LTQsNGD0L3QvtCyINC/0L4g0LrQu9C40LrRgyDQstC90LUg0LjRhVxyXG4gIC8vIFxyXG4gIGZ1bmN0aW9uIGNsb3NlT3V0RHJvcGRvd24oZHJvcERvd24sIGlucHV0KSB7XHJcblxyXG4gICAgJChkb2N1bWVudCkubW91c2V1cChmdW5jdGlvbiAoZSl7IC8vINGB0L7QsdGL0YLQuNC1INC60LvQuNC60LAg0L/QviDQstC10LEt0LTQvtC60YPQvNC10L3RgtGDXHJcbiAgICAgIHZhciBkcm9wID0gJChkcm9wRG93bik7IC8vINGC0YPRgiDRg9C60LDQt9GL0LLQsNC10LwgSUQg0Y3Qu9C10LzQtdC90YLQsFxyXG4gICAgICB2YXIgaW5wID0gJChpbnB1dCk7XHJcbiAgICAgIGlmIChpbnAuaXMoZS50YXJnZXQpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9IGVsc2UgaWYgKCFkcm9wLmlzKGUudGFyZ2V0KSAvLyDQtdGB0LvQuCDQutC70LjQuiDQsdGL0Lsg0L3QtSDQv9C+INC90LDRiNC10LzRgyDQsdC70L7QutGDXHJcbiAgICAgICAgICAmJiBkcm9wLmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwKSB7IC8vINC4INC90LUg0L/QviDQtdCz0L4g0LTQvtGH0LXRgNC90LjQvCDRjdC70LXQvNC10L3RgtCw0LxcclxuICAgICAgICBkcm9wLmhpZGUoKTsgLy8g0YHQutGA0YvQstCw0LXQvCDQtdCz0L5cclxuICAgICAgfSBcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGNsb3NlT3V0RHJvcGRvd24oJy5mb3JtX19kcm9wZG93bicsICcuZm9ybV9fc2VsZWN0ZWQnKTtcclxuICBjbG9zZU91dERyb3Bkb3duKCcucHJvamVjdHMtZmlsdGVyX19kcm9wZG93bicsICcucHJvamVjdHMtZmlsdGVyX19zZWxlY3RlZCcpO1xyXG4gIGNsb3NlT3V0RHJvcGRvd24oJy5mb3JtLXJldmlld19fZHJvcGRvd24nLCAnLmZvcm0tcmV2aWV3X19zZWxlY3RlZCcpO1xyXG5cclxuICBmdW5jdGlvbiBjbGlja1NlbGVjdChzZWxlY3QsIGRyb3BMaXN0KXtcclxuXHJcbiAgICAkKHNlbGVjdCkub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICBcclxuICAgICAgdmFyIGRyb3BEb3duID0gJCh0aGlzKS5maW5kKGRyb3BMaXN0KTtcclxuICAgICAgdmFyIGV2ZXJEcm9wRG93biA9ICQoZHJvcExpc3QpO1xyXG4gICAgICBcclxuICAgICAgaWYgKCBkcm9wRG93bi5pcygnOnZpc2libGUnKSApIHtcclxuICAgICAgICBldmVyRHJvcERvd24uaGlkZSgpO1xyXG4gICAgICB9IGVsc2UgaWYgKCBkcm9wRG93bi5pcygnOmhpZGRlbicpICkge1xyXG4gICAgICAgIGV2ZXJEcm9wRG93bi5oaWRlKCk7XHJcbiAgICAgICAgZHJvcERvd24uc2hvdygpO1xyXG4gICAgICB9IFxyXG4gICAgICBcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGNsaWNrU2VsZWN0KCcuZm9ybV9fc2VsZWN0JywgJy5mb3JtX19kcm9wZG93bicpO1xyXG4gIGNsaWNrU2VsZWN0KCcucHJvamVjdHMtZmlsdGVyX19zZWxlY3QnLCAnLnByb2plY3RzLWZpbHRlcl9fZHJvcGRvd24nKTtcclxuICBjbGlja1NlbGVjdCgnLmZvcm0tcmV2aWV3X19zZWxlY3QnLCAnLmZvcm0tcmV2aWV3X19kcm9wZG93bicpO1xyXG5cclxuICBcclxuXHJcblxyXG4gIC8vINCX0LDQutGA0YvRgtC40LUg0LTRgNC+0L/RgtCw0LTRg9C90L7QsiDQv9C+INC60LvQuNC60YMg0L3QsCDQtNGA0YPQs9C+0Lkg0YHQtdC70LXQutGCXHJcbiAgLy8gXHJcbiAgLy8gXHJcbiAgLy8gXHJcbiAgJChmdW5jdGlvbigpe1xyXG5cclxuICAgIHZhciBkYXRlRW5kID0gJCgnI2NvdW50ZG93bi1wcm9tbycpLmRhdGEoJ3RpbWVyLWhvdXJzJyk7XHJcbiAgXHJcbiAgICB2YXIgbm90ZSA9ICQoJyNub3RlJyksXHJcbiAgICAgIHRzID0gbmV3IERhdGUoMjAxMiwgMCwgMSksXHJcbiAgICAgIG5ld1llYXIgPSB0cnVlO1xyXG4gICAgXHJcbiAgICBpZigobmV3IERhdGUoKSkgPiB0cyl7XHJcbiAgICAgIC8vIFRoZSBuZXcgeWVhciBpcyBoZXJlISBDb3VudCB0b3dhcmRzIHNvbWV0aGluZyBlbHNlLlxyXG4gICAgICAvLyBOb3RpY2UgdGhlICoxMDAwIGF0IHRoZSBlbmQgLSB0aW1lIG11c3QgYmUgaW4gbWlsbGlzZWNvbmRzXHJcbiAgICAgIHRzID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKSArIGRhdGVFbmQqMjQqNjAqNjAqMTAwMDtcclxuICAgICAgbmV3WWVhciA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAgIFxyXG4gICAgJCgnI2NvdW50ZG93bi1wcm9tbycpLmNvdW50ZG93bih7XHJcbiAgICAgIHRpbWVzdGFtcCA6IHRzLFxyXG4gICAgICBjYWxsYmFjayAgOiBmdW5jdGlvbihkYXlzLCBob3VycywgbWludXRlcywgc2Vjb25kcyl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSBcIlwiO1xyXG4gICAgICAgIFxyXG4gICAgICAgIG1lc3NhZ2UgKz0gZGF5cyArIFwiIGRheVwiICsgKCBkYXlzPT0xID8gJyc6J3MnICkgKyBcIiwgXCI7XHJcbiAgICAgICAgbWVzc2FnZSArPSBob3VycyArIFwiIGhvdXJcIiArICggaG91cnM9PTEgPyAnJzoncycgKSArIFwiLCBcIjtcclxuICAgICAgICBtZXNzYWdlICs9IG1pbnV0ZXMgKyBcIiBtaW51dGVcIiArICggbWludXRlcz09MSA/ICcnOidzJyApICsgXCIgYW5kIFwiO1xyXG4gICAgICAgIG1lc3NhZ2UgKz0gc2Vjb25kcyArIFwiIHNlY29uZFwiICsgKCBzZWNvbmRzPT0xID8gJyc6J3MnICkgKyBcIiA8YnIgLz5cIjtcclxuICAgICAgICBcclxuICAgICAgICBpZihuZXdZZWFyKXtcclxuICAgICAgICAgIG1lc3NhZ2UgKz0gXCJsZWZ0IHVudGlsIHRoZSBuZXcgeWVhciFcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBtZXNzYWdlICs9IFwibGVmdCB0byAxMCBkYXlzIGZyb20gbm93IVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBub3RlLmh0bWwobWVzc2FnZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgfSk7XHJcblxyXG5cclxufSk7Il19
