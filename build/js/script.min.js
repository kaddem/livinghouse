$(document).ready(function(){

  console.log('yep, jQuery work!');
  $('.promo-slider').slick({
    dots: true
    // autoplay: true,
    // autoplaySpeed: 500
  });

  // $('.review__slider-preview-item')
  // 

  $('.review__slider-big').slick({
    slidesToShow: 1,
    slidesToScroll: 1,
    arrows: false,
    fade: true,
    asNavFor: '.review__slider-preview'
  });

  $('.review__slider-preview').slick({
    slidesToShow: 4,
    slidesToScroll: 1,
    asNavFor: '.review__slider-big',
    dots: false,
    centerMode: false,
    focusOnSelect: true,
    responsive: [
      {
        breakpoint: 1200,
        settings: {
          slidesToShow: 2
        }
      }
      // },
      // {
      //   breakpoint: 768,
      //   settings: {
      //     slidesToShow: 0,
      //     settings: "unslick"
      //   }
      // }
      // You can unslick at a given breakpoint now by adding:
      // settings: "unslick"
      // instead of a settings object
    ]
  });

});

$(window).load(function () {
  function ratioPhoto(block) {
    $(block).each(function(){
      var itemWidth = $(this).width();
      var itemHeight = $(this).height();
      var itemRatio = itemHeight / itemWidth;

      var photo = $(this).find('img');
      var photoWidth = photo.width();
      var photoHeight = photo.height();
      var photoRatio = photoHeight / photoWidth;

      if ( itemRatio < photoRatio ) {
        photo.width('100%');
        photo.height('auto');
      } else if (itemRatio > photoRatio) {
        photo.height('100%');
        photo.width('auto');
      } else {
        photo.width('100%');
        photo.height('auto');
      }
    });
  }

  function ratioLetter(block) {
    $(block).each(function(){
      var itemWidth = $(this).width();
      var itemHeight = $(this).height();
      var itemRatio = itemHeight / itemWidth;

      var photo = $(this).find('img');
      var photoWidth = photo.width();
      var photoHeight = photo.height();
      var photoRatio = photoHeight / photoWidth;

      if ( itemRatio > photoRatio ) {
        photo.width('100%');
      } else if (itemRatio < photoRatio) {
        photo.height('100%');
      } else {
        photo.width('100%');
      }
    });
  }

  ratioPhoto('.review__slider-preview-item');
  ratioPhoto('.review__slider-big-item');
  ratioLetter('.review__letter-box');
  ratioLetter('.review__chart-box');
  ratioPhoto('.gallery__item');
  ratioPhoto('.project-card__photo');
  ratioPhoto('.review-card__visual');
  ratioPhoto('.project__photo');

  $(window).resize(function(){
    ratioPhoto('.review__slider-preview-item');
    ratioPhoto('.review__slider-big-item');
    ratioLetter('.review__letter-box');
    ratioLetter('.review__chart-box');
    ratioPhoto('.gallery__item');
    ratioPhoto('.project-card__photo');
    ratioPhoto('.review-card__visual');
    ratioPhoto('.project__photo');
  });

  function tabs(boxTabsLink, boxTabsContent, tabs){ 
    $(boxTabsLink + ' input').on('click', function(e){
      var attrLink = $(this).attr('id');
      console.log(attrLink);
      $(boxTabsContent + ' ' + tabs).css("display", "none");
      $(boxTabsContent + ' .' + attrLink).css("display", "block");
    }); 
  };


  tabs('#tabs-roof', '#tabs-roof-content', '.project-form__table-select--roof-content');
  tabs('#tabs-frame', '#tabs-frame-content', '.project-form__tab-item');



  // бургер, что тут еще скажешь? но без колы(
  $('.burger').on('click', function(e){
      e.preventDefault();
      if ( $(this).hasClass("burger--close") ) {
          $(this).removeClass('burger--close');
          $('.main-nav').slideUp(400);
          $('.main-nav').removeClass('main-nav--open');
          $('.page-header').removeClass('page-header--open');
      } else {
          $(this).addClass('burger--close');
          $('.main-nav').slideDown(400);
          $('.main-nav').addClass('main-nav--open');
          $('.page-header').addClass('page-header--open');
      }
  });

  $('.nav ul a').on('click', function(e){
      if ($(window).width() < 768) {
          $('.main-nav').slideUp(400);
          $('.burger').addClass('burger--open');
          $('.burger').removeClass('burger--close');
      };
  });


  $(window).resize(function(){
      if( $(window).width() > 767 ) {
          $('.main-nav').show();
      } else {
          $('.main-nav').slideUp(400);
          $('.main-nav').removeClass('main-nav--open');
          $('.page-header').removeClass('page-header--open');
          $('.burger').removeClass('burger--close');
      }
  });

  $(window).on('scroll', function(e) { // отслеживаем событие на элементе window
    if( $(window).width() < 768 ) {
        $('.main-nav').slideUp(400);
        $('.main-nav').removeClass('main-nav--open');
        $('.page-header').removeClass('page-header--open');
        $('.burger').removeClass('burger--close');
    }
  });

  if ( $(window).scrollTop() > 100 && $(window).width() > 767) {
    $('.page-header').addClass('page-header--scroll');
    $('.page-header').addClass('page-header--desktop');
  } else if ( $(window).scrollTop() > 100 ) {
    $('.page-header').addClass('page-header--scroll');
  }

  $(window).on('scroll', function(e) {

    if ( $(window).scrollTop() > 100 && $(window).width() > 1199 ) {
      $('.page-header').addClass('page-header--scroll');
      $('.page-header').addClass('page-header--desktop');
    } else if ( $(window).scrollTop() > 100 ) {
      $('.page-header').addClass('page-header--scroll');
      $('.page-header').removeClass('page-header--desktop');
    } else {
      $('.page-header').removeClass('page-header--scroll');
      $('.page-header').removeClass('page-header--desktop');
    }

  });

  function telMask(selector) {
    $(selector).mask('+7 (000) 000-00-00');
  }

  telMask('.contact-form__input--tel');
  telMask('.consult__input-tel');

  $('.projects-filter__select').on('click', function(){
    var dropdown = $(this).find('.projects-filter__dropdown');
    dropdown.toggle();
  })

  $('.form-review__select').on('click', function(){
    var dropdown = $(this).find('.form-review__dropdown');
    dropdown.toggle();
  })

  $('.form__select').on('click', function(){
    var dropdown = $(this).find('.form__dropdown');
    dropdown.toggle();
  })
  // кастомизация выпадающего списка - select
  // $('select').selecter();
  




  // Ползунок для форм
  
  $(function() {
    var priceStart = $('.form__cost--start').data('price-start');
    console.log(priceStart);
    var priceEnd = $('.form__cost--end').data('price-end');
    console.log(priceStart);

    $( "#form-slider-ui" ).slider({
      // orientation: "vertical",
      // step: 15,
      range: true,
      min: priceStart,
      max: priceEnd,
      values: [ priceStart, priceEnd ],
      slide: function( event, ui ) {
        $( "#amount_start" ).val( ui.values[ 0 ] );
        $( "#amount_end" ).val( ui.values[ 1 ] );
      }
    });
    $( "#amount_start" ).val( $( "#form-slider-ui" ).slider( "values", 0 ) );
    $( "#amount_end" ).val( $( "#form-slider-ui" ).slider( "values", 1 ) );

    // Изменение местоположения ползунка при вводиде данных в первый элемент input
    $("input#amount").change(function(){
      var value1=$("input#amount_start").val();
      var value2=$("input#amount_1").val();
        if(parseInt(value1) > parseInt(value2)){
        value1 = value2;
        $("input#amount_start").val(value1);
      }
      $("#form-slider-ui").slider("values",0,value1); 
    });
        
    // Изменение местоположения ползунка при вводиде данных в второй элемент input  
    $("input#amount_1").change(function(){
      var value1=$("input#amount_start").val();
      var value2=$("input#amount_end").val();

      if(parseInt(value1) > parseInt(value2)){
        value2 = value1;
        $("input#amount_end").val(value2);
      }
      $("#form-slider-ui").slider("values",1,value2);
    });

    // фильтрация ввода в поля
    jQuery('#amount_start, #amount_end').keypress(function(event){
      var key, keyChar;
      if(!event) var event = window.event;
      
      if (event.keyCode) key = event.keyCode;
      else if(event.which) key = event.which;
    
      if(key==null || key==0 || key==8 || key==13 || key==9 || key==46 || key==37 || key==39 ) return true;
      keyChar=String.fromCharCode(key);
      
      if(!/\d/.test(keyChar)) return false;
    
    });

  });

});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe1xyXG5cclxuICBjb25zb2xlLmxvZygneWVwLCBqUXVlcnkgd29yayEnKTtcclxuICAkKCcucHJvbW8tc2xpZGVyJykuc2xpY2soe1xyXG4gICAgZG90czogdHJ1ZVxyXG4gICAgLy8gYXV0b3BsYXk6IHRydWUsXHJcbiAgICAvLyBhdXRvcGxheVNwZWVkOiA1MDBcclxuICB9KTtcclxuXHJcbiAgLy8gJCgnLnJldmlld19fc2xpZGVyLXByZXZpZXctaXRlbScpXHJcbiAgLy8gXHJcblxyXG4gICQoJy5yZXZpZXdfX3NsaWRlci1iaWcnKS5zbGljayh7XHJcbiAgICBzbGlkZXNUb1Nob3c6IDEsXHJcbiAgICBzbGlkZXNUb1Njcm9sbDogMSxcclxuICAgIGFycm93czogZmFsc2UsXHJcbiAgICBmYWRlOiB0cnVlLFxyXG4gICAgYXNOYXZGb3I6ICcucmV2aWV3X19zbGlkZXItcHJldmlldydcclxuICB9KTtcclxuXHJcbiAgJCgnLnJldmlld19fc2xpZGVyLXByZXZpZXcnKS5zbGljayh7XHJcbiAgICBzbGlkZXNUb1Nob3c6IDQsXHJcbiAgICBzbGlkZXNUb1Njcm9sbDogMSxcclxuICAgIGFzTmF2Rm9yOiAnLnJldmlld19fc2xpZGVyLWJpZycsXHJcbiAgICBkb3RzOiBmYWxzZSxcclxuICAgIGNlbnRlck1vZGU6IGZhbHNlLFxyXG4gICAgZm9jdXNPblNlbGVjdDogdHJ1ZSxcclxuICAgIHJlc3BvbnNpdmU6IFtcclxuICAgICAge1xyXG4gICAgICAgIGJyZWFrcG9pbnQ6IDEyMDAsXHJcbiAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgIHNsaWRlc1RvU2hvdzogMlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvLyB9LFxyXG4gICAgICAvLyB7XHJcbiAgICAgIC8vICAgYnJlYWtwb2ludDogNzY4LFxyXG4gICAgICAvLyAgIHNldHRpbmdzOiB7XHJcbiAgICAgIC8vICAgICBzbGlkZXNUb1Nob3c6IDAsXHJcbiAgICAgIC8vICAgICBzZXR0aW5nczogXCJ1bnNsaWNrXCJcclxuICAgICAgLy8gICB9XHJcbiAgICAgIC8vIH1cclxuICAgICAgLy8gWW91IGNhbiB1bnNsaWNrIGF0IGEgZ2l2ZW4gYnJlYWtwb2ludCBub3cgYnkgYWRkaW5nOlxyXG4gICAgICAvLyBzZXR0aW5nczogXCJ1bnNsaWNrXCJcclxuICAgICAgLy8gaW5zdGVhZCBvZiBhIHNldHRpbmdzIG9iamVjdFxyXG4gICAgXVxyXG4gIH0pO1xyXG5cclxufSk7XHJcblxyXG4kKHdpbmRvdykubG9hZChmdW5jdGlvbiAoKSB7XHJcbiAgZnVuY3Rpb24gcmF0aW9QaG90byhibG9jaykge1xyXG4gICAgJChibG9jaykuZWFjaChmdW5jdGlvbigpe1xyXG4gICAgICB2YXIgaXRlbVdpZHRoID0gJCh0aGlzKS53aWR0aCgpO1xyXG4gICAgICB2YXIgaXRlbUhlaWdodCA9ICQodGhpcykuaGVpZ2h0KCk7XHJcbiAgICAgIHZhciBpdGVtUmF0aW8gPSBpdGVtSGVpZ2h0IC8gaXRlbVdpZHRoO1xyXG5cclxuICAgICAgdmFyIHBob3RvID0gJCh0aGlzKS5maW5kKCdpbWcnKTtcclxuICAgICAgdmFyIHBob3RvV2lkdGggPSBwaG90by53aWR0aCgpO1xyXG4gICAgICB2YXIgcGhvdG9IZWlnaHQgPSBwaG90by5oZWlnaHQoKTtcclxuICAgICAgdmFyIHBob3RvUmF0aW8gPSBwaG90b0hlaWdodCAvIHBob3RvV2lkdGg7XHJcblxyXG4gICAgICBpZiAoIGl0ZW1SYXRpbyA8IHBob3RvUmF0aW8gKSB7XHJcbiAgICAgICAgcGhvdG8ud2lkdGgoJzEwMCUnKTtcclxuICAgICAgICBwaG90by5oZWlnaHQoJ2F1dG8nKTtcclxuICAgICAgfSBlbHNlIGlmIChpdGVtUmF0aW8gPiBwaG90b1JhdGlvKSB7XHJcbiAgICAgICAgcGhvdG8uaGVpZ2h0KCcxMDAlJyk7XHJcbiAgICAgICAgcGhvdG8ud2lkdGgoJ2F1dG8nKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBwaG90by53aWR0aCgnMTAwJScpO1xyXG4gICAgICAgIHBob3RvLmhlaWdodCgnYXV0bycpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJhdGlvTGV0dGVyKGJsb2NrKSB7XHJcbiAgICAkKGJsb2NrKS5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgIHZhciBpdGVtV2lkdGggPSAkKHRoaXMpLndpZHRoKCk7XHJcbiAgICAgIHZhciBpdGVtSGVpZ2h0ID0gJCh0aGlzKS5oZWlnaHQoKTtcclxuICAgICAgdmFyIGl0ZW1SYXRpbyA9IGl0ZW1IZWlnaHQgLyBpdGVtV2lkdGg7XHJcblxyXG4gICAgICB2YXIgcGhvdG8gPSAkKHRoaXMpLmZpbmQoJ2ltZycpO1xyXG4gICAgICB2YXIgcGhvdG9XaWR0aCA9IHBob3RvLndpZHRoKCk7XHJcbiAgICAgIHZhciBwaG90b0hlaWdodCA9IHBob3RvLmhlaWdodCgpO1xyXG4gICAgICB2YXIgcGhvdG9SYXRpbyA9IHBob3RvSGVpZ2h0IC8gcGhvdG9XaWR0aDtcclxuXHJcbiAgICAgIGlmICggaXRlbVJhdGlvID4gcGhvdG9SYXRpbyApIHtcclxuICAgICAgICBwaG90by53aWR0aCgnMTAwJScpO1xyXG4gICAgICB9IGVsc2UgaWYgKGl0ZW1SYXRpbyA8IHBob3RvUmF0aW8pIHtcclxuICAgICAgICBwaG90by5oZWlnaHQoJzEwMCUnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBwaG90by53aWR0aCgnMTAwJScpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJhdGlvUGhvdG8oJy5yZXZpZXdfX3NsaWRlci1wcmV2aWV3LWl0ZW0nKTtcclxuICByYXRpb1Bob3RvKCcucmV2aWV3X19zbGlkZXItYmlnLWl0ZW0nKTtcclxuICByYXRpb0xldHRlcignLnJldmlld19fbGV0dGVyLWJveCcpO1xyXG4gIHJhdGlvTGV0dGVyKCcucmV2aWV3X19jaGFydC1ib3gnKTtcclxuICByYXRpb1Bob3RvKCcuZ2FsbGVyeV9faXRlbScpO1xyXG4gIHJhdGlvUGhvdG8oJy5wcm9qZWN0LWNhcmRfX3Bob3RvJyk7XHJcbiAgcmF0aW9QaG90bygnLnJldmlldy1jYXJkX192aXN1YWwnKTtcclxuICByYXRpb1Bob3RvKCcucHJvamVjdF9fcGhvdG8nKTtcclxuXHJcbiAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpe1xyXG4gICAgcmF0aW9QaG90bygnLnJldmlld19fc2xpZGVyLXByZXZpZXctaXRlbScpO1xyXG4gICAgcmF0aW9QaG90bygnLnJldmlld19fc2xpZGVyLWJpZy1pdGVtJyk7XHJcbiAgICByYXRpb0xldHRlcignLnJldmlld19fbGV0dGVyLWJveCcpO1xyXG4gICAgcmF0aW9MZXR0ZXIoJy5yZXZpZXdfX2NoYXJ0LWJveCcpO1xyXG4gICAgcmF0aW9QaG90bygnLmdhbGxlcnlfX2l0ZW0nKTtcclxuICAgIHJhdGlvUGhvdG8oJy5wcm9qZWN0LWNhcmRfX3Bob3RvJyk7XHJcbiAgICByYXRpb1Bob3RvKCcucmV2aWV3LWNhcmRfX3Zpc3VhbCcpO1xyXG4gICAgcmF0aW9QaG90bygnLnByb2plY3RfX3Bob3RvJyk7XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIHRhYnMoYm94VGFic0xpbmssIGJveFRhYnNDb250ZW50LCB0YWJzKXsgXHJcbiAgICAkKGJveFRhYnNMaW5rICsgJyBpbnB1dCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICB2YXIgYXR0ckxpbmsgPSAkKHRoaXMpLmF0dHIoJ2lkJyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGF0dHJMaW5rKTtcclxuICAgICAgJChib3hUYWJzQ29udGVudCArICcgJyArIHRhYnMpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xyXG4gICAgICAkKGJveFRhYnNDb250ZW50ICsgJyAuJyArIGF0dHJMaW5rKS5jc3MoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIik7XHJcbiAgICB9KTsgXHJcbiAgfTtcclxuXHJcblxyXG4gIHRhYnMoJyN0YWJzLXJvb2YnLCAnI3RhYnMtcm9vZi1jb250ZW50JywgJy5wcm9qZWN0LWZvcm1fX3RhYmxlLXNlbGVjdC0tcm9vZi1jb250ZW50Jyk7XHJcbiAgdGFicygnI3RhYnMtZnJhbWUnLCAnI3RhYnMtZnJhbWUtY29udGVudCcsICcucHJvamVjdC1mb3JtX190YWItaXRlbScpO1xyXG5cclxuXHJcblxyXG4gIC8vINCx0YPRgNCz0LXRgCwg0YfRgtC+INGC0YPRgiDQtdGJ0LUg0YHQutCw0LbQtdGI0Yw/INC90L4g0LHQtdC3INC60L7Qu9GLKFxyXG4gICQoJy5idXJnZXInKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBpZiAoICQodGhpcykuaGFzQ2xhc3MoXCJidXJnZXItLWNsb3NlXCIpICkge1xyXG4gICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYnVyZ2VyLS1jbG9zZScpO1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2Jykuc2xpZGVVcCg0MDApO1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2JykucmVtb3ZlQ2xhc3MoJ21haW4tbmF2LS1vcGVuJyk7XHJcbiAgICAgICAgICAkKCcucGFnZS1oZWFkZXInKS5yZW1vdmVDbGFzcygncGFnZS1oZWFkZXItLW9wZW4nKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2J1cmdlci0tY2xvc2UnKTtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnNsaWRlRG93big0MDApO1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2JykuYWRkQ2xhc3MoJ21haW4tbmF2LS1vcGVuJyk7XHJcbiAgICAgICAgICAkKCcucGFnZS1oZWFkZXInKS5hZGRDbGFzcygncGFnZS1oZWFkZXItLW9wZW4nKTtcclxuICAgICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKCcubmF2IHVsIGEnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNzY4KSB7XHJcbiAgICAgICAgICAkKCcubWFpbi1uYXYnKS5zbGlkZVVwKDQwMCk7XHJcbiAgICAgICAgICAkKCcuYnVyZ2VyJykuYWRkQ2xhc3MoJ2J1cmdlci0tb3BlbicpO1xyXG4gICAgICAgICAgJCgnLmJ1cmdlcicpLnJlbW92ZUNsYXNzKCdidXJnZXItLWNsb3NlJyk7XHJcbiAgICAgIH07XHJcbiAgfSk7XHJcblxyXG5cclxuICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCl7XHJcbiAgICAgIGlmKCAkKHdpbmRvdykud2lkdGgoKSA+IDc2NyApIHtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnNob3coKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnNsaWRlVXAoNDAwKTtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnJlbW92ZUNsYXNzKCdtYWluLW5hdi0tb3BlbicpO1xyXG4gICAgICAgICAgJCgnLnBhZ2UtaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1vcGVuJyk7XHJcbiAgICAgICAgICAkKCcuYnVyZ2VyJykucmVtb3ZlQ2xhc3MoJ2J1cmdlci0tY2xvc2UnKTtcclxuICAgICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKHdpbmRvdykub24oJ3Njcm9sbCcsIGZ1bmN0aW9uKGUpIHsgLy8g0L7RgtGB0LvQtdC20LjQstCw0LXQvCDRgdC+0LHRi9GC0LjQtSDQvdCwINGN0LvQtdC80LXQvdGC0LUgd2luZG93XHJcbiAgICBpZiggJCh3aW5kb3cpLndpZHRoKCkgPCA3NjggKSB7XHJcbiAgICAgICAgJCgnLm1haW4tbmF2Jykuc2xpZGVVcCg0MDApO1xyXG4gICAgICAgICQoJy5tYWluLW5hdicpLnJlbW92ZUNsYXNzKCdtYWluLW5hdi0tb3BlbicpO1xyXG4gICAgICAgICQoJy5wYWdlLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdwYWdlLWhlYWRlci0tb3BlbicpO1xyXG4gICAgICAgICQoJy5idXJnZXInKS5yZW1vdmVDbGFzcygnYnVyZ2VyLS1jbG9zZScpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBpZiAoICQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwMCAmJiAkKHdpbmRvdykud2lkdGgoKSA+IDc2Nykge1xyXG4gICAgJCgnLnBhZ2UtaGVhZGVyJykuYWRkQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1zY3JvbGwnKTtcclxuICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tZGVza3RvcCcpO1xyXG4gIH0gZWxzZSBpZiAoICQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwMCApIHtcclxuICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tc2Nyb2xsJyk7XHJcbiAgfVxyXG5cclxuICAkKHdpbmRvdykub24oJ3Njcm9sbCcsIGZ1bmN0aW9uKGUpIHtcclxuXHJcbiAgICBpZiAoICQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwMCAmJiAkKHdpbmRvdykud2lkdGgoKSA+IDExOTkgKSB7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tc2Nyb2xsJyk7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tZGVza3RvcCcpO1xyXG4gICAgfSBlbHNlIGlmICggJCh3aW5kb3cpLnNjcm9sbFRvcCgpID4gMTAwICkge1xyXG4gICAgICAkKCcucGFnZS1oZWFkZXInKS5hZGRDbGFzcygncGFnZS1oZWFkZXItLXNjcm9sbCcpO1xyXG4gICAgICAkKCcucGFnZS1oZWFkZXInKS5yZW1vdmVDbGFzcygncGFnZS1oZWFkZXItLWRlc2t0b3AnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdwYWdlLWhlYWRlci0tc2Nyb2xsJyk7XHJcbiAgICAgICQoJy5wYWdlLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdwYWdlLWhlYWRlci0tZGVza3RvcCcpO1xyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gdGVsTWFzayhzZWxlY3Rvcikge1xyXG4gICAgJChzZWxlY3RvcikubWFzaygnKzcgKDAwMCkgMDAwLTAwLTAwJyk7XHJcbiAgfVxyXG5cclxuICB0ZWxNYXNrKCcuY29udGFjdC1mb3JtX19pbnB1dC0tdGVsJyk7XHJcbiAgdGVsTWFzaygnLmNvbnN1bHRfX2lucHV0LXRlbCcpO1xyXG5cclxuICAkKCcucHJvamVjdHMtZmlsdGVyX19zZWxlY3QnKS5vbignY2xpY2snLCBmdW5jdGlvbigpe1xyXG4gICAgdmFyIGRyb3Bkb3duID0gJCh0aGlzKS5maW5kKCcucHJvamVjdHMtZmlsdGVyX19kcm9wZG93bicpO1xyXG4gICAgZHJvcGRvd24udG9nZ2xlKCk7XHJcbiAgfSlcclxuXHJcbiAgJCgnLmZvcm0tcmV2aWV3X19zZWxlY3QnKS5vbignY2xpY2snLCBmdW5jdGlvbigpe1xyXG4gICAgdmFyIGRyb3Bkb3duID0gJCh0aGlzKS5maW5kKCcuZm9ybS1yZXZpZXdfX2Ryb3Bkb3duJyk7XHJcbiAgICBkcm9wZG93bi50b2dnbGUoKTtcclxuICB9KVxyXG5cclxuICAkKCcuZm9ybV9fc2VsZWN0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAgIHZhciBkcm9wZG93biA9ICQodGhpcykuZmluZCgnLmZvcm1fX2Ryb3Bkb3duJyk7XHJcbiAgICBkcm9wZG93bi50b2dnbGUoKTtcclxuICB9KVxyXG4gIC8vINC60LDRgdGC0L7QvNC40LfQsNGG0LjRjyDQstGL0L/QsNC00LDRjtGJ0LXQs9C+INGB0L/QuNGB0LrQsCAtIHNlbGVjdFxyXG4gIC8vICQoJ3NlbGVjdCcpLnNlbGVjdGVyKCk7XHJcbiAgXHJcblxyXG5cclxuXHJcblxyXG4gIC8vINCf0L7Qu9C30YPQvdC+0Log0LTQu9GPINGE0L7RgNC8XHJcbiAgXHJcbiAgJChmdW5jdGlvbigpIHtcclxuICAgIHZhciBwcmljZVN0YXJ0ID0gJCgnLmZvcm1fX2Nvc3QtLXN0YXJ0JykuZGF0YSgncHJpY2Utc3RhcnQnKTtcclxuICAgIGNvbnNvbGUubG9nKHByaWNlU3RhcnQpO1xyXG4gICAgdmFyIHByaWNlRW5kID0gJCgnLmZvcm1fX2Nvc3QtLWVuZCcpLmRhdGEoJ3ByaWNlLWVuZCcpO1xyXG4gICAgY29uc29sZS5sb2cocHJpY2VTdGFydCk7XHJcblxyXG4gICAgJCggXCIjZm9ybS1zbGlkZXItdWlcIiApLnNsaWRlcih7XHJcbiAgICAgIC8vIG9yaWVudGF0aW9uOiBcInZlcnRpY2FsXCIsXHJcbiAgICAgIC8vIHN0ZXA6IDE1LFxyXG4gICAgICByYW5nZTogdHJ1ZSxcclxuICAgICAgbWluOiBwcmljZVN0YXJ0LFxyXG4gICAgICBtYXg6IHByaWNlRW5kLFxyXG4gICAgICB2YWx1ZXM6IFsgcHJpY2VTdGFydCwgcHJpY2VFbmQgXSxcclxuICAgICAgc2xpZGU6IGZ1bmN0aW9uKCBldmVudCwgdWkgKSB7XHJcbiAgICAgICAgJCggXCIjYW1vdW50X3N0YXJ0XCIgKS52YWwoIHVpLnZhbHVlc1sgMCBdICk7XHJcbiAgICAgICAgJCggXCIjYW1vdW50X2VuZFwiICkudmFsKCB1aS52YWx1ZXNbIDEgXSApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgICQoIFwiI2Ftb3VudF9zdGFydFwiICkudmFsKCAkKCBcIiNmb3JtLXNsaWRlci11aVwiICkuc2xpZGVyKCBcInZhbHVlc1wiLCAwICkgKTtcclxuICAgICQoIFwiI2Ftb3VudF9lbmRcIiApLnZhbCggJCggXCIjZm9ybS1zbGlkZXItdWlcIiApLnNsaWRlciggXCJ2YWx1ZXNcIiwgMSApICk7XHJcblxyXG4gICAgLy8g0JjQt9C80LXQvdC10L3QuNC1INC80LXRgdGC0L7Qv9C+0LvQvtC20LXQvdC40Y8g0L/QvtC70LfRg9C90LrQsCDQv9GA0Lgg0LLQstC+0LTQuNC00LUg0LTQsNC90L3Ri9GFINCyINC/0LXRgNCy0YvQuSDRjdC70LXQvNC10L3RgiBpbnB1dFxyXG4gICAgJChcImlucHV0I2Ftb3VudFwiKS5jaGFuZ2UoZnVuY3Rpb24oKXtcclxuICAgICAgdmFyIHZhbHVlMT0kKFwiaW5wdXQjYW1vdW50X3N0YXJ0XCIpLnZhbCgpO1xyXG4gICAgICB2YXIgdmFsdWUyPSQoXCJpbnB1dCNhbW91bnRfMVwiKS52YWwoKTtcclxuICAgICAgICBpZihwYXJzZUludCh2YWx1ZTEpID4gcGFyc2VJbnQodmFsdWUyKSl7XHJcbiAgICAgICAgdmFsdWUxID0gdmFsdWUyO1xyXG4gICAgICAgICQoXCJpbnB1dCNhbW91bnRfc3RhcnRcIikudmFsKHZhbHVlMSk7XHJcbiAgICAgIH1cclxuICAgICAgJChcIiNmb3JtLXNsaWRlci11aVwiKS5zbGlkZXIoXCJ2YWx1ZXNcIiwwLHZhbHVlMSk7IFxyXG4gICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAvLyDQmNC30LzQtdC90LXQvdC40LUg0LzQtdGB0YLQvtC/0L7Qu9C+0LbQtdC90LjRjyDQv9C+0LvQt9GD0L3QutCwINC/0YDQuCDQstCy0L7QtNC40LTQtSDQtNCw0L3QvdGL0YUg0LIg0LLRgtC+0YDQvtC5INGN0LvQtdC80LXQvdGCIGlucHV0ICBcclxuICAgICQoXCJpbnB1dCNhbW91bnRfMVwiKS5jaGFuZ2UoZnVuY3Rpb24oKXtcclxuICAgICAgdmFyIHZhbHVlMT0kKFwiaW5wdXQjYW1vdW50X3N0YXJ0XCIpLnZhbCgpO1xyXG4gICAgICB2YXIgdmFsdWUyPSQoXCJpbnB1dCNhbW91bnRfZW5kXCIpLnZhbCgpO1xyXG5cclxuICAgICAgaWYocGFyc2VJbnQodmFsdWUxKSA+IHBhcnNlSW50KHZhbHVlMikpe1xyXG4gICAgICAgIHZhbHVlMiA9IHZhbHVlMTtcclxuICAgICAgICAkKFwiaW5wdXQjYW1vdW50X2VuZFwiKS52YWwodmFsdWUyKTtcclxuICAgICAgfVxyXG4gICAgICAkKFwiI2Zvcm0tc2xpZGVyLXVpXCIpLnNsaWRlcihcInZhbHVlc1wiLDEsdmFsdWUyKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vINGE0LjQu9GM0YLRgNCw0YbQuNGPINCy0LLQvtC00LAg0LIg0L/QvtC70Y9cclxuICAgIGpRdWVyeSgnI2Ftb3VudF9zdGFydCwgI2Ftb3VudF9lbmQnKS5rZXlwcmVzcyhmdW5jdGlvbihldmVudCl7XHJcbiAgICAgIHZhciBrZXksIGtleUNoYXI7XHJcbiAgICAgIGlmKCFldmVudCkgdmFyIGV2ZW50ID0gd2luZG93LmV2ZW50O1xyXG4gICAgICBcclxuICAgICAgaWYgKGV2ZW50LmtleUNvZGUpIGtleSA9IGV2ZW50LmtleUNvZGU7XHJcbiAgICAgIGVsc2UgaWYoZXZlbnQud2hpY2gpIGtleSA9IGV2ZW50LndoaWNoO1xyXG4gICAgXHJcbiAgICAgIGlmKGtleT09bnVsbCB8fCBrZXk9PTAgfHwga2V5PT04IHx8IGtleT09MTMgfHwga2V5PT05IHx8IGtleT09NDYgfHwga2V5PT0zNyB8fCBrZXk9PTM5ICkgcmV0dXJuIHRydWU7XHJcbiAgICAgIGtleUNoYXI9U3RyaW5nLmZyb21DaGFyQ29kZShrZXkpO1xyXG4gICAgICBcclxuICAgICAgaWYoIS9cXGQvLnRlc3Qoa2V5Q2hhcikpIHJldHVybiBmYWxzZTtcclxuICAgIFxyXG4gICAgfSk7XHJcblxyXG4gIH0pO1xyXG5cclxufSk7Il19
