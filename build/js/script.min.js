$(document).ready(function(){

  console.log('yep, jQuery work!');
  $('.promo-slider').slick({
    dots: true
    // autoplay: true,
    // autoplaySpeed: 500
  });

  // $('.review__slider-preview-item')
  // 

  $('.review__slider-big').slick({
    slidesToShow: 1,
    slidesToScroll: 1,
    arrows: false,
    fade: true,
    asNavFor: '.review__slider-preview'
  });

  $('.review__slider-preview').slick({
    slidesToShow: 4,
    slidesToScroll: 1,
    asNavFor: '.review__slider-big',
    dots: false,
    centerMode: false,
    focusOnSelect: true,
    responsive: [
      {
        breakpoint: 1200,
        settings: {
          slidesToShow: 2
        }
      }
      // },
      // {
      //   breakpoint: 768,
      //   settings: {
      //     slidesToShow: 0,
      //     settings: "unslick"
      //   }
      // }
      // You can unslick at a given breakpoint now by adding:
      // settings: "unslick"
      // instead of a settings object
    ]
  });

});

$(window).load(function () {
  function ratioPhoto(block) {
    $(block).each(function(){
      var itemWidth = $(this).width();
      var itemHeight = $(this).height();
      var itemRatio = itemHeight / itemWidth;

      var photo = $(this).find('img');
      var photoWidth = photo.width();
      var photoHeight = photo.height();
      var photoRatio = photoHeight / photoWidth;

      if ( itemRatio < photoRatio ) {
        photo.width('100%');
        photo.height('auto');
      } else if (itemRatio > photoRatio) {
        photo.height('100%');
        photo.width('auto');
      } else {
        photo.width('100%');
        photo.height('auto');
      }
    });
  }

  function ratioLetter(block) {
    $(block).each(function(){
      var itemWidth = $(this).width();
      var itemHeight = $(this).height();
      var itemRatio = itemHeight / itemWidth;

      var photo = $(this).find('img');
      var photoWidth = photo.width();
      var photoHeight = photo.height();
      var photoRatio = photoHeight / photoWidth;

      if ( itemRatio > photoRatio ) {
        photo.width('100%');
      } else if (itemRatio < photoRatio) {
        photo.height('100%');
      } else {
        photo.width('100%');
      }
    });
  }

  ratioPhoto('.review__slider-preview-item');
  ratioPhoto('.review__slider-big-item');
  ratioLetter('.review__letter-box');
  ratioLetter('.review__chart-box');
  ratioPhoto('.gallery__item');
  ratioPhoto('.project-card__photo');
  ratioPhoto('.review-card__visual');
  ratioPhoto('.project__photo');

  $(window).resize(function(){
    ratioPhoto('.review__slider-preview-item');
    ratioPhoto('.review__slider-big-item');
    ratioLetter('.review__letter-box');
    ratioLetter('.review__chart-box');
    ratioPhoto('.gallery__item');
    ratioPhoto('.project-card__photo');
    ratioPhoto('.review-card__visual');
    ratioPhoto('.project__photo');
  });

  function tabs(boxTabsLink, boxTabsContent, tabs){ 
    $(boxTabsLink + ' input').on('click', function(e){
      var attrLink = $(this).attr('id');
      console.log(attrLink);
      $(boxTabsContent + ' ' + tabs).css("display", "none");
      $(boxTabsContent + ' .' + attrLink).css("display", "block");
    }); 
  };


  tabs('#tabs-roof', '#tabs-roof-content', '.project-form__table-select--roof-content');
  tabs('#tabs-frame', '#tabs-frame-content', '.project-form__tab-item');



  // бургер, что тут еще скажешь? но без колы(
  $('.burger').on('click', function(e){
      e.preventDefault();
      if ( $(this).hasClass("burger--close") ) {
          $(this).removeClass('burger--close');
          $('.main-nav').slideUp(400);
          $('.main-nav').removeClass('main-nav--open');
          $('.page-header').removeClass('page-header--open');
      } else {
          $(this).addClass('burger--close');
          $('.main-nav').slideDown(400);
          $('.main-nav').addClass('main-nav--open');
          $('.page-header').addClass('page-header--open');
      }
  });

  $('.nav ul a').on('click', function(e){
      if ($(window).width() < 768) {
          $('.main-nav').slideUp(400);
          $('.burger').addClass('burger--open');
          $('.burger').removeClass('burger--close');
      };
  });


  $(window).resize(function(){
      if( $(window).width() > 767 ) {
          $('.main-nav').show();
      } else {
          $('.main-nav').slideUp(400);
          $('.main-nav').removeClass('main-nav--open');
          $('.page-header').removeClass('page-header--open');
          $('.burger').removeClass('burger--close');
      }
  });

  $(window).on('scroll', function(e) { // отслеживаем событие на элементе window
    if( $(window).width() < 768 ) {
        $('.main-nav').slideUp(400);
        $('.main-nav').removeClass('main-nav--open');
        $('.page-header').removeClass('page-header--open');
        $('.burger').removeClass('burger--close');
    }
  });

  if ( $(window).scrollTop() > 100 && $(window).width() > 767) {
    $('.page-header').addClass('page-header--scroll');
    $('.page-header').addClass('page-header--desktop');
  } else if ( $(window).scrollTop() > 100 ) {
    $('.page-header').addClass('page-header--scroll');
  }

  $(window).on('scroll', function(e) {

    if ( $(window).scrollTop() > 100 && $(window).width() > 1199 ) {
      $('.page-header').addClass('page-header--scroll');
      $('.page-header').addClass('page-header--desktop');
    } else if ( $(window).scrollTop() > 100 ) {
      $('.page-header').addClass('page-header--scroll');
      $('.page-header').removeClass('page-header--desktop');
    } else {
      $('.page-header').removeClass('page-header--scroll');
      $('.page-header').removeClass('page-header--desktop');
    }

  });

  function telMask(selector) {
    $(selector).mask('+7 (000) 000-00-00');
  }

  telMask('.contact-form__input--tel');
  telMask('.consult__input-tel');

  // $('.projects-filter__select').on('click', function(){
  //   var dropdown = $(this).find('.projects-filter__dropdown');
  //   var everDropdown = $('.projects-filter__dropdown');
  //   everDropdown.hide();
  //   dropdown.toggle();
  // })

  // $('.form-review__select').on('click', function(){
  //   var dropdown = $(this).find('.form-review__dropdown');
  //   dropdown.toggle();
  // })

  
  // кастомизация выпадающего списка - select
  // $('select').selecter();
  




  // Ползунок для форм
  
  $(function() {
    var priceStart = $('.form__cost--start').data('price-start');
    console.log(priceStart);
    var priceEnd = $('.form__cost--end').data('price-end');
    console.log(priceStart);

    $( "#form-slider-ui" ).slider({
      // orientation: "vertical",
      // step: 15,
      range: true,
      min: priceStart,
      max: priceEnd,
      values: [ priceStart, priceEnd ],
      slide: function( event, ui ) {
        $( "#amount_start" ).val( ui.values[ 0 ] );
        $( "#amount_end" ).val( ui.values[ 1 ] );
      }
    });
    $( "#amount_start" ).val( $( "#form-slider-ui" ).slider( "values", 0 ) );
    $( "#amount_end" ).val( $( "#form-slider-ui" ).slider( "values", 1 ) );

    // Изменение местоположения ползунка при вводиде данных в первый элемент input
    $("input#amount").change(function(){
      var value1=$("input#amount_start").val();
      var value2=$("input#amount_1").val();
        if(parseInt(value1) > parseInt(value2)){
        value1 = value2;
        $("input#amount_start").val(value1);
      }
      $("#form-slider-ui").slider("values",0,value1); 
    });
        
    // Изменение местоположения ползунка при вводиде данных в второй элемент input  
    $("input#amount_1").change(function(){
      var value1=$("input#amount_start").val();
      var value2=$("input#amount_end").val();

      if(parseInt(value1) > parseInt(value2)){
        value2 = value1;
        $("input#amount_end").val(value2);
      }
      $("#form-slider-ui").slider("values",1,value2);
    });

    // фильтрация ввода в поля
    jQuery('#amount_start, #amount_end').keypress(function(event){
      var key, keyChar;
      if(!event) var event = window.event;
      
      if (event.keyCode) key = event.keyCode;
      else if(event.which) key = event.which;
    
      if(key==null || key==0 || key==8 || key==13 || key==9 || key==46 || key==37 || key==39 ) return true;
      keyChar=String.fromCharCode(key);
      
      if(!/\d/.test(keyChar)) return false;
    
    });

  });


  // Закрытие дропдаунов по клику вне их
  // 
  function closeOutDropdown(dropDown, input) {

    $(document).mouseup(function (e){ // событие клика по веб-документу
      var drop = $(dropDown); // тут указываем ID элемента
      var inp = $(input);
      if (inp.is(e.target)) {
        return;
      } else if (!drop.is(e.target) // если клик был не по нашему блоку
          && drop.has(e.target).length === 0) { // и не по его дочерним элементам
        drop.hide(); // скрываем его
      } 
    });

  }

  closeOutDropdown('.form__dropdown', '.form__selected');
  closeOutDropdown('.projects-filter__dropdown', '.projects-filter__selected');
  closeOutDropdown('.form-review__dropdown', '.form-review__selected');

  function clickSelect(select, dropList){

    $(select).on('click', function(e){
    
      var dropDown = $(this).find(dropList);
      var everDropDown = $(dropList);
      
      if ( dropDown.is(':visible') ) {
        everDropDown.hide();
      } else if ( dropDown.is(':hidden') ) {
        everDropDown.hide();
        dropDown.show();
      } 
      
    });

  }

  clickSelect('.form__select', '.form__dropdown');
  clickSelect('.projects-filter__select', '.projects-filter__dropdown');
  clickSelect('.form-review__select', '.form-review__dropdown');

  


  // Закрытие дроптадунов по клику на другой селект
  // 


});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcclxuXHJcbiAgY29uc29sZS5sb2coJ3llcCwgalF1ZXJ5IHdvcmshJyk7XHJcbiAgJCgnLnByb21vLXNsaWRlcicpLnNsaWNrKHtcclxuICAgIGRvdHM6IHRydWVcclxuICAgIC8vIGF1dG9wbGF5OiB0cnVlLFxyXG4gICAgLy8gYXV0b3BsYXlTcGVlZDogNTAwXHJcbiAgfSk7XHJcblxyXG4gIC8vICQoJy5yZXZpZXdfX3NsaWRlci1wcmV2aWV3LWl0ZW0nKVxyXG4gIC8vIFxyXG5cclxuICAkKCcucmV2aWV3X19zbGlkZXItYmlnJykuc2xpY2soe1xyXG4gICAgc2xpZGVzVG9TaG93OiAxLFxyXG4gICAgc2xpZGVzVG9TY3JvbGw6IDEsXHJcbiAgICBhcnJvd3M6IGZhbHNlLFxyXG4gICAgZmFkZTogdHJ1ZSxcclxuICAgIGFzTmF2Rm9yOiAnLnJldmlld19fc2xpZGVyLXByZXZpZXcnXHJcbiAgfSk7XHJcblxyXG4gICQoJy5yZXZpZXdfX3NsaWRlci1wcmV2aWV3Jykuc2xpY2soe1xyXG4gICAgc2xpZGVzVG9TaG93OiA0LFxyXG4gICAgc2xpZGVzVG9TY3JvbGw6IDEsXHJcbiAgICBhc05hdkZvcjogJy5yZXZpZXdfX3NsaWRlci1iaWcnLFxyXG4gICAgZG90czogZmFsc2UsXHJcbiAgICBjZW50ZXJNb2RlOiBmYWxzZSxcclxuICAgIGZvY3VzT25TZWxlY3Q6IHRydWUsXHJcbiAgICByZXNwb25zaXZlOiBbXHJcbiAgICAgIHtcclxuICAgICAgICBicmVha3BvaW50OiAxMjAwLFxyXG4gICAgICAgIHNldHRpbmdzOiB7XHJcbiAgICAgICAgICBzbGlkZXNUb1Nob3c6IDJcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLy8gfSxcclxuICAgICAgLy8ge1xyXG4gICAgICAvLyAgIGJyZWFrcG9pbnQ6IDc2OCxcclxuICAgICAgLy8gICBzZXR0aW5nczoge1xyXG4gICAgICAvLyAgICAgc2xpZGVzVG9TaG93OiAwLFxyXG4gICAgICAvLyAgICAgc2V0dGluZ3M6IFwidW5zbGlja1wiXHJcbiAgICAgIC8vICAgfVxyXG4gICAgICAvLyB9XHJcbiAgICAgIC8vIFlvdSBjYW4gdW5zbGljayBhdCBhIGdpdmVuIGJyZWFrcG9pbnQgbm93IGJ5IGFkZGluZzpcclxuICAgICAgLy8gc2V0dGluZ3M6IFwidW5zbGlja1wiXHJcbiAgICAgIC8vIGluc3RlYWQgb2YgYSBzZXR0aW5ncyBvYmplY3RcclxuICAgIF1cclxuICB9KTtcclxuXHJcbn0pO1xyXG5cclxuJCh3aW5kb3cpLmxvYWQoZnVuY3Rpb24gKCkge1xyXG4gIGZ1bmN0aW9uIHJhdGlvUGhvdG8oYmxvY2spIHtcclxuICAgICQoYmxvY2spLmVhY2goZnVuY3Rpb24oKXtcclxuICAgICAgdmFyIGl0ZW1XaWR0aCA9ICQodGhpcykud2lkdGgoKTtcclxuICAgICAgdmFyIGl0ZW1IZWlnaHQgPSAkKHRoaXMpLmhlaWdodCgpO1xyXG4gICAgICB2YXIgaXRlbVJhdGlvID0gaXRlbUhlaWdodCAvIGl0ZW1XaWR0aDtcclxuXHJcbiAgICAgIHZhciBwaG90byA9ICQodGhpcykuZmluZCgnaW1nJyk7XHJcbiAgICAgIHZhciBwaG90b1dpZHRoID0gcGhvdG8ud2lkdGgoKTtcclxuICAgICAgdmFyIHBob3RvSGVpZ2h0ID0gcGhvdG8uaGVpZ2h0KCk7XHJcbiAgICAgIHZhciBwaG90b1JhdGlvID0gcGhvdG9IZWlnaHQgLyBwaG90b1dpZHRoO1xyXG5cclxuICAgICAgaWYgKCBpdGVtUmF0aW8gPCBwaG90b1JhdGlvICkge1xyXG4gICAgICAgIHBob3RvLndpZHRoKCcxMDAlJyk7XHJcbiAgICAgICAgcGhvdG8uaGVpZ2h0KCdhdXRvJyk7XHJcbiAgICAgIH0gZWxzZSBpZiAoaXRlbVJhdGlvID4gcGhvdG9SYXRpbykge1xyXG4gICAgICAgIHBob3RvLmhlaWdodCgnMTAwJScpO1xyXG4gICAgICAgIHBob3RvLndpZHRoKCdhdXRvJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcGhvdG8ud2lkdGgoJzEwMCUnKTtcclxuICAgICAgICBwaG90by5oZWlnaHQoJ2F1dG8nKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByYXRpb0xldHRlcihibG9jaykge1xyXG4gICAgJChibG9jaykuZWFjaChmdW5jdGlvbigpe1xyXG4gICAgICB2YXIgaXRlbVdpZHRoID0gJCh0aGlzKS53aWR0aCgpO1xyXG4gICAgICB2YXIgaXRlbUhlaWdodCA9ICQodGhpcykuaGVpZ2h0KCk7XHJcbiAgICAgIHZhciBpdGVtUmF0aW8gPSBpdGVtSGVpZ2h0IC8gaXRlbVdpZHRoO1xyXG5cclxuICAgICAgdmFyIHBob3RvID0gJCh0aGlzKS5maW5kKCdpbWcnKTtcclxuICAgICAgdmFyIHBob3RvV2lkdGggPSBwaG90by53aWR0aCgpO1xyXG4gICAgICB2YXIgcGhvdG9IZWlnaHQgPSBwaG90by5oZWlnaHQoKTtcclxuICAgICAgdmFyIHBob3RvUmF0aW8gPSBwaG90b0hlaWdodCAvIHBob3RvV2lkdGg7XHJcblxyXG4gICAgICBpZiAoIGl0ZW1SYXRpbyA+IHBob3RvUmF0aW8gKSB7XHJcbiAgICAgICAgcGhvdG8ud2lkdGgoJzEwMCUnKTtcclxuICAgICAgfSBlbHNlIGlmIChpdGVtUmF0aW8gPCBwaG90b1JhdGlvKSB7XHJcbiAgICAgICAgcGhvdG8uaGVpZ2h0KCcxMDAlJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcGhvdG8ud2lkdGgoJzEwMCUnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByYXRpb1Bob3RvKCcucmV2aWV3X19zbGlkZXItcHJldmlldy1pdGVtJyk7XHJcbiAgcmF0aW9QaG90bygnLnJldmlld19fc2xpZGVyLWJpZy1pdGVtJyk7XHJcbiAgcmF0aW9MZXR0ZXIoJy5yZXZpZXdfX2xldHRlci1ib3gnKTtcclxuICByYXRpb0xldHRlcignLnJldmlld19fY2hhcnQtYm94Jyk7XHJcbiAgcmF0aW9QaG90bygnLmdhbGxlcnlfX2l0ZW0nKTtcclxuICByYXRpb1Bob3RvKCcucHJvamVjdC1jYXJkX19waG90bycpO1xyXG4gIHJhdGlvUGhvdG8oJy5yZXZpZXctY2FyZF9fdmlzdWFsJyk7XHJcbiAgcmF0aW9QaG90bygnLnByb2plY3RfX3Bob3RvJyk7XHJcblxyXG4gICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKXtcclxuICAgIHJhdGlvUGhvdG8oJy5yZXZpZXdfX3NsaWRlci1wcmV2aWV3LWl0ZW0nKTtcclxuICAgIHJhdGlvUGhvdG8oJy5yZXZpZXdfX3NsaWRlci1iaWctaXRlbScpO1xyXG4gICAgcmF0aW9MZXR0ZXIoJy5yZXZpZXdfX2xldHRlci1ib3gnKTtcclxuICAgIHJhdGlvTGV0dGVyKCcucmV2aWV3X19jaGFydC1ib3gnKTtcclxuICAgIHJhdGlvUGhvdG8oJy5nYWxsZXJ5X19pdGVtJyk7XHJcbiAgICByYXRpb1Bob3RvKCcucHJvamVjdC1jYXJkX19waG90bycpO1xyXG4gICAgcmF0aW9QaG90bygnLnJldmlldy1jYXJkX192aXN1YWwnKTtcclxuICAgIHJhdGlvUGhvdG8oJy5wcm9qZWN0X19waG90bycpO1xyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiB0YWJzKGJveFRhYnNMaW5rLCBib3hUYWJzQ29udGVudCwgdGFicyl7IFxyXG4gICAgJChib3hUYWJzTGluayArICcgaW5wdXQnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgdmFyIGF0dHJMaW5rID0gJCh0aGlzKS5hdHRyKCdpZCcpO1xyXG4gICAgICBjb25zb2xlLmxvZyhhdHRyTGluayk7XHJcbiAgICAgICQoYm94VGFic0NvbnRlbnQgKyAnICcgKyB0YWJzKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcclxuICAgICAgJChib3hUYWJzQ29udGVudCArICcgLicgKyBhdHRyTGluaykuY3NzKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpO1xyXG4gICAgfSk7IFxyXG4gIH07XHJcblxyXG5cclxuICB0YWJzKCcjdGFicy1yb29mJywgJyN0YWJzLXJvb2YtY29udGVudCcsICcucHJvamVjdC1mb3JtX190YWJsZS1zZWxlY3QtLXJvb2YtY29udGVudCcpO1xyXG4gIHRhYnMoJyN0YWJzLWZyYW1lJywgJyN0YWJzLWZyYW1lLWNvbnRlbnQnLCAnLnByb2plY3QtZm9ybV9fdGFiLWl0ZW0nKTtcclxuXHJcblxyXG5cclxuICAvLyDQsdGD0YDQs9C10YAsINGH0YLQviDRgtGD0YIg0LXRidC1INGB0LrQsNC20LXRiNGMPyDQvdC+INCx0LXQtyDQutC+0LvRiyhcclxuICAkKCcuYnVyZ2VyJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgaWYgKCAkKHRoaXMpLmhhc0NsYXNzKFwiYnVyZ2VyLS1jbG9zZVwiKSApIHtcclxuICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2J1cmdlci0tY2xvc2UnKTtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnNsaWRlVXAoNDAwKTtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLnJlbW92ZUNsYXNzKCdtYWluLW5hdi0tb3BlbicpO1xyXG4gICAgICAgICAgJCgnLnBhZ2UtaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1vcGVuJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdidXJnZXItLWNsb3NlJyk7XHJcbiAgICAgICAgICAkKCcubWFpbi1uYXYnKS5zbGlkZURvd24oNDAwKTtcclxuICAgICAgICAgICQoJy5tYWluLW5hdicpLmFkZENsYXNzKCdtYWluLW5hdi0tb3BlbicpO1xyXG4gICAgICAgICAgJCgnLnBhZ2UtaGVhZGVyJykuYWRkQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1vcGVuJyk7XHJcbiAgICAgIH1cclxuICB9KTtcclxuXHJcbiAgJCgnLm5hdiB1bCBhJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8IDc2OCkge1xyXG4gICAgICAgICAgJCgnLm1haW4tbmF2Jykuc2xpZGVVcCg0MDApO1xyXG4gICAgICAgICAgJCgnLmJ1cmdlcicpLmFkZENsYXNzKCdidXJnZXItLW9wZW4nKTtcclxuICAgICAgICAgICQoJy5idXJnZXInKS5yZW1vdmVDbGFzcygnYnVyZ2VyLS1jbG9zZScpO1xyXG4gICAgICB9O1xyXG4gIH0pO1xyXG5cclxuXHJcbiAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpe1xyXG4gICAgICBpZiggJCh3aW5kb3cpLndpZHRoKCkgPiA3NjcgKSB7XHJcbiAgICAgICAgICAkKCcubWFpbi1uYXYnKS5zaG93KCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAkKCcubWFpbi1uYXYnKS5zbGlkZVVwKDQwMCk7XHJcbiAgICAgICAgICAkKCcubWFpbi1uYXYnKS5yZW1vdmVDbGFzcygnbWFpbi1uYXYtLW9wZW4nKTtcclxuICAgICAgICAgICQoJy5wYWdlLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdwYWdlLWhlYWRlci0tb3BlbicpO1xyXG4gICAgICAgICAgJCgnLmJ1cmdlcicpLnJlbW92ZUNsYXNzKCdidXJnZXItLWNsb3NlJyk7XHJcbiAgICAgIH1cclxuICB9KTtcclxuXHJcbiAgJCh3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbihlKSB7IC8vINC+0YLRgdC70LXQttC40LLQsNC10Lwg0YHQvtCx0YvRgtC40LUg0L3QsCDRjdC70LXQvNC10L3RgtC1IHdpbmRvd1xyXG4gICAgaWYoICQod2luZG93KS53aWR0aCgpIDwgNzY4ICkge1xyXG4gICAgICAgICQoJy5tYWluLW5hdicpLnNsaWRlVXAoNDAwKTtcclxuICAgICAgICAkKCcubWFpbi1uYXYnKS5yZW1vdmVDbGFzcygnbWFpbi1uYXYtLW9wZW4nKTtcclxuICAgICAgICAkKCcucGFnZS1oZWFkZXInKS5yZW1vdmVDbGFzcygncGFnZS1oZWFkZXItLW9wZW4nKTtcclxuICAgICAgICAkKCcuYnVyZ2VyJykucmVtb3ZlQ2xhc3MoJ2J1cmdlci0tY2xvc2UnKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgaWYgKCAkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAxMDAgJiYgJCh3aW5kb3cpLndpZHRoKCkgPiA3NjcpIHtcclxuICAgICQoJy5wYWdlLWhlYWRlcicpLmFkZENsYXNzKCdwYWdlLWhlYWRlci0tc2Nyb2xsJyk7XHJcbiAgICAkKCcucGFnZS1oZWFkZXInKS5hZGRDbGFzcygncGFnZS1oZWFkZXItLWRlc2t0b3AnKTtcclxuICB9IGVsc2UgaWYgKCAkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAxMDAgKSB7XHJcbiAgICAkKCcucGFnZS1oZWFkZXInKS5hZGRDbGFzcygncGFnZS1oZWFkZXItLXNjcm9sbCcpO1xyXG4gIH1cclxuXHJcbiAgJCh3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbihlKSB7XHJcblxyXG4gICAgaWYgKCAkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPiAxMDAgJiYgJCh3aW5kb3cpLndpZHRoKCkgPiAxMTk5ICkge1xyXG4gICAgICAkKCcucGFnZS1oZWFkZXInKS5hZGRDbGFzcygncGFnZS1oZWFkZXItLXNjcm9sbCcpO1xyXG4gICAgICAkKCcucGFnZS1oZWFkZXInKS5hZGRDbGFzcygncGFnZS1oZWFkZXItLWRlc2t0b3AnKTtcclxuICAgIH0gZWxzZSBpZiAoICQod2luZG93KS5zY3JvbGxUb3AoKSA+IDEwMCApIHtcclxuICAgICAgJCgnLnBhZ2UtaGVhZGVyJykuYWRkQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1zY3JvbGwnKTtcclxuICAgICAgJCgnLnBhZ2UtaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ3BhZ2UtaGVhZGVyLS1kZXNrdG9wJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAkKCcucGFnZS1oZWFkZXInKS5yZW1vdmVDbGFzcygncGFnZS1oZWFkZXItLXNjcm9sbCcpO1xyXG4gICAgICAkKCcucGFnZS1oZWFkZXInKS5yZW1vdmVDbGFzcygncGFnZS1oZWFkZXItLWRlc2t0b3AnKTtcclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIHRlbE1hc2soc2VsZWN0b3IpIHtcclxuICAgICQoc2VsZWN0b3IpLm1hc2soJys3ICgwMDApIDAwMC0wMC0wMCcpO1xyXG4gIH1cclxuXHJcbiAgdGVsTWFzaygnLmNvbnRhY3QtZm9ybV9faW5wdXQtLXRlbCcpO1xyXG4gIHRlbE1hc2soJy5jb25zdWx0X19pbnB1dC10ZWwnKTtcclxuXHJcbiAgLy8gJCgnLnByb2plY3RzLWZpbHRlcl9fc2VsZWN0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAvLyAgIHZhciBkcm9wZG93biA9ICQodGhpcykuZmluZCgnLnByb2plY3RzLWZpbHRlcl9fZHJvcGRvd24nKTtcclxuICAvLyAgIHZhciBldmVyRHJvcGRvd24gPSAkKCcucHJvamVjdHMtZmlsdGVyX19kcm9wZG93bicpO1xyXG4gIC8vICAgZXZlckRyb3Bkb3duLmhpZGUoKTtcclxuICAvLyAgIGRyb3Bkb3duLnRvZ2dsZSgpO1xyXG4gIC8vIH0pXHJcblxyXG4gIC8vICQoJy5mb3JtLXJldmlld19fc2VsZWN0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAvLyAgIHZhciBkcm9wZG93biA9ICQodGhpcykuZmluZCgnLmZvcm0tcmV2aWV3X19kcm9wZG93bicpO1xyXG4gIC8vICAgZHJvcGRvd24udG9nZ2xlKCk7XHJcbiAgLy8gfSlcclxuXHJcbiAgXHJcbiAgLy8g0LrQsNGB0YLQvtC80LjQt9Cw0YbQuNGPINCy0YvQv9Cw0LTQsNGO0YnQtdCz0L4g0YHQv9C40YHQutCwIC0gc2VsZWN0XHJcbiAgLy8gJCgnc2VsZWN0Jykuc2VsZWN0ZXIoKTtcclxuICBcclxuXHJcblxyXG5cclxuXHJcbiAgLy8g0J/QvtC70LfRg9C90L7QuiDQtNC70Y8g0YTQvtGA0LxcclxuICBcclxuICAkKGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHByaWNlU3RhcnQgPSAkKCcuZm9ybV9fY29zdC0tc3RhcnQnKS5kYXRhKCdwcmljZS1zdGFydCcpO1xyXG4gICAgY29uc29sZS5sb2cocHJpY2VTdGFydCk7XHJcbiAgICB2YXIgcHJpY2VFbmQgPSAkKCcuZm9ybV9fY29zdC0tZW5kJykuZGF0YSgncHJpY2UtZW5kJyk7XHJcbiAgICBjb25zb2xlLmxvZyhwcmljZVN0YXJ0KTtcclxuXHJcbiAgICAkKCBcIiNmb3JtLXNsaWRlci11aVwiICkuc2xpZGVyKHtcclxuICAgICAgLy8gb3JpZW50YXRpb246IFwidmVydGljYWxcIixcclxuICAgICAgLy8gc3RlcDogMTUsXHJcbiAgICAgIHJhbmdlOiB0cnVlLFxyXG4gICAgICBtaW46IHByaWNlU3RhcnQsXHJcbiAgICAgIG1heDogcHJpY2VFbmQsXHJcbiAgICAgIHZhbHVlczogWyBwcmljZVN0YXJ0LCBwcmljZUVuZCBdLFxyXG4gICAgICBzbGlkZTogZnVuY3Rpb24oIGV2ZW50LCB1aSApIHtcclxuICAgICAgICAkKCBcIiNhbW91bnRfc3RhcnRcIiApLnZhbCggdWkudmFsdWVzWyAwIF0gKTtcclxuICAgICAgICAkKCBcIiNhbW91bnRfZW5kXCIgKS52YWwoIHVpLnZhbHVlc1sgMSBdICk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgJCggXCIjYW1vdW50X3N0YXJ0XCIgKS52YWwoICQoIFwiI2Zvcm0tc2xpZGVyLXVpXCIgKS5zbGlkZXIoIFwidmFsdWVzXCIsIDAgKSApO1xyXG4gICAgJCggXCIjYW1vdW50X2VuZFwiICkudmFsKCAkKCBcIiNmb3JtLXNsaWRlci11aVwiICkuc2xpZGVyKCBcInZhbHVlc1wiLCAxICkgKTtcclxuXHJcbiAgICAvLyDQmNC30LzQtdC90LXQvdC40LUg0LzQtdGB0YLQvtC/0L7Qu9C+0LbQtdC90LjRjyDQv9C+0LvQt9GD0L3QutCwINC/0YDQuCDQstCy0L7QtNC40LTQtSDQtNCw0L3QvdGL0YUg0LIg0L/QtdGA0LLRi9C5INGN0LvQtdC80LXQvdGCIGlucHV0XHJcbiAgICAkKFwiaW5wdXQjYW1vdW50XCIpLmNoYW5nZShmdW5jdGlvbigpe1xyXG4gICAgICB2YXIgdmFsdWUxPSQoXCJpbnB1dCNhbW91bnRfc3RhcnRcIikudmFsKCk7XHJcbiAgICAgIHZhciB2YWx1ZTI9JChcImlucHV0I2Ftb3VudF8xXCIpLnZhbCgpO1xyXG4gICAgICAgIGlmKHBhcnNlSW50KHZhbHVlMSkgPiBwYXJzZUludCh2YWx1ZTIpKXtcclxuICAgICAgICB2YWx1ZTEgPSB2YWx1ZTI7XHJcbiAgICAgICAgJChcImlucHV0I2Ftb3VudF9zdGFydFwiKS52YWwodmFsdWUxKTtcclxuICAgICAgfVxyXG4gICAgICAkKFwiI2Zvcm0tc2xpZGVyLXVpXCIpLnNsaWRlcihcInZhbHVlc1wiLDAsdmFsdWUxKTsgXHJcbiAgICB9KTtcclxuICAgICAgICBcclxuICAgIC8vINCY0LfQvNC10L3QtdC90LjQtSDQvNC10YHRgtC+0L/QvtC70L7QttC10L3QuNGPINC/0L7Qu9C30YPQvdC60LAg0L/RgNC4INCy0LLQvtC00LjQtNC1INC00LDQvdC90YvRhSDQsiDQstGC0L7RgNC+0Lkg0Y3Qu9C10LzQtdC90YIgaW5wdXQgIFxyXG4gICAgJChcImlucHV0I2Ftb3VudF8xXCIpLmNoYW5nZShmdW5jdGlvbigpe1xyXG4gICAgICB2YXIgdmFsdWUxPSQoXCJpbnB1dCNhbW91bnRfc3RhcnRcIikudmFsKCk7XHJcbiAgICAgIHZhciB2YWx1ZTI9JChcImlucHV0I2Ftb3VudF9lbmRcIikudmFsKCk7XHJcblxyXG4gICAgICBpZihwYXJzZUludCh2YWx1ZTEpID4gcGFyc2VJbnQodmFsdWUyKSl7XHJcbiAgICAgICAgdmFsdWUyID0gdmFsdWUxO1xyXG4gICAgICAgICQoXCJpbnB1dCNhbW91bnRfZW5kXCIpLnZhbCh2YWx1ZTIpO1xyXG4gICAgICB9XHJcbiAgICAgICQoXCIjZm9ybS1zbGlkZXItdWlcIikuc2xpZGVyKFwidmFsdWVzXCIsMSx2YWx1ZTIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8g0YTQuNC70YzRgtGA0LDRhtC40Y8g0LLQstC+0LTQsCDQsiDQv9C+0LvRj1xyXG4gICAgalF1ZXJ5KCcjYW1vdW50X3N0YXJ0LCAjYW1vdW50X2VuZCcpLmtleXByZXNzKGZ1bmN0aW9uKGV2ZW50KXtcclxuICAgICAgdmFyIGtleSwga2V5Q2hhcjtcclxuICAgICAgaWYoIWV2ZW50KSB2YXIgZXZlbnQgPSB3aW5kb3cuZXZlbnQ7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZXZlbnQua2V5Q29kZSkga2V5ID0gZXZlbnQua2V5Q29kZTtcclxuICAgICAgZWxzZSBpZihldmVudC53aGljaCkga2V5ID0gZXZlbnQud2hpY2g7XHJcbiAgICBcclxuICAgICAgaWYoa2V5PT1udWxsIHx8IGtleT09MCB8fCBrZXk9PTggfHwga2V5PT0xMyB8fCBrZXk9PTkgfHwga2V5PT00NiB8fCBrZXk9PTM3IHx8IGtleT09MzkgKSByZXR1cm4gdHJ1ZTtcclxuICAgICAga2V5Q2hhcj1TdHJpbmcuZnJvbUNoYXJDb2RlKGtleSk7XHJcbiAgICAgIFxyXG4gICAgICBpZighL1xcZC8udGVzdChrZXlDaGFyKSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgXHJcbiAgICB9KTtcclxuXHJcbiAgfSk7XHJcblxyXG5cclxuICAvLyDQl9Cw0LrRgNGL0YLQuNC1INC00YDQvtC/0LTQsNGD0L3QvtCyINC/0L4g0LrQu9C40LrRgyDQstC90LUg0LjRhVxyXG4gIC8vIFxyXG4gIGZ1bmN0aW9uIGNsb3NlT3V0RHJvcGRvd24oZHJvcERvd24sIGlucHV0KSB7XHJcblxyXG4gICAgJChkb2N1bWVudCkubW91c2V1cChmdW5jdGlvbiAoZSl7IC8vINGB0L7QsdGL0YLQuNC1INC60LvQuNC60LAg0L/QviDQstC10LEt0LTQvtC60YPQvNC10L3RgtGDXHJcbiAgICAgIHZhciBkcm9wID0gJChkcm9wRG93bik7IC8vINGC0YPRgiDRg9C60LDQt9GL0LLQsNC10LwgSUQg0Y3Qu9C10LzQtdC90YLQsFxyXG4gICAgICB2YXIgaW5wID0gJChpbnB1dCk7XHJcbiAgICAgIGlmIChpbnAuaXMoZS50YXJnZXQpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9IGVsc2UgaWYgKCFkcm9wLmlzKGUudGFyZ2V0KSAvLyDQtdGB0LvQuCDQutC70LjQuiDQsdGL0Lsg0L3QtSDQv9C+INC90LDRiNC10LzRgyDQsdC70L7QutGDXHJcbiAgICAgICAgICAmJiBkcm9wLmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwKSB7IC8vINC4INC90LUg0L/QviDQtdCz0L4g0LTQvtGH0LXRgNC90LjQvCDRjdC70LXQvNC10L3RgtCw0LxcclxuICAgICAgICBkcm9wLmhpZGUoKTsgLy8g0YHQutGA0YvQstCw0LXQvCDQtdCz0L5cclxuICAgICAgfSBcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGNsb3NlT3V0RHJvcGRvd24oJy5mb3JtX19kcm9wZG93bicsICcuZm9ybV9fc2VsZWN0ZWQnKTtcclxuICBjbG9zZU91dERyb3Bkb3duKCcucHJvamVjdHMtZmlsdGVyX19kcm9wZG93bicsICcucHJvamVjdHMtZmlsdGVyX19zZWxlY3RlZCcpO1xyXG4gIGNsb3NlT3V0RHJvcGRvd24oJy5mb3JtLXJldmlld19fZHJvcGRvd24nLCAnLmZvcm0tcmV2aWV3X19zZWxlY3RlZCcpO1xyXG5cclxuICBmdW5jdGlvbiBjbGlja1NlbGVjdChzZWxlY3QsIGRyb3BMaXN0KXtcclxuXHJcbiAgICAkKHNlbGVjdCkub24oJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICBcclxuICAgICAgdmFyIGRyb3BEb3duID0gJCh0aGlzKS5maW5kKGRyb3BMaXN0KTtcclxuICAgICAgdmFyIGV2ZXJEcm9wRG93biA9ICQoZHJvcExpc3QpO1xyXG4gICAgICBcclxuICAgICAgaWYgKCBkcm9wRG93bi5pcygnOnZpc2libGUnKSApIHtcclxuICAgICAgICBldmVyRHJvcERvd24uaGlkZSgpO1xyXG4gICAgICB9IGVsc2UgaWYgKCBkcm9wRG93bi5pcygnOmhpZGRlbicpICkge1xyXG4gICAgICAgIGV2ZXJEcm9wRG93bi5oaWRlKCk7XHJcbiAgICAgICAgZHJvcERvd24uc2hvdygpO1xyXG4gICAgICB9IFxyXG4gICAgICBcclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGNsaWNrU2VsZWN0KCcuZm9ybV9fc2VsZWN0JywgJy5mb3JtX19kcm9wZG93bicpO1xyXG4gIGNsaWNrU2VsZWN0KCcucHJvamVjdHMtZmlsdGVyX19zZWxlY3QnLCAnLnByb2plY3RzLWZpbHRlcl9fZHJvcGRvd24nKTtcclxuICBjbGlja1NlbGVjdCgnLmZvcm0tcmV2aWV3X19zZWxlY3QnLCAnLmZvcm0tcmV2aWV3X19kcm9wZG93bicpO1xyXG5cclxuICBcclxuXHJcblxyXG4gIC8vINCX0LDQutGA0YvRgtC40LUg0LTRgNC+0L/RgtCw0LTRg9C90L7QsiDQv9C+INC60LvQuNC60YMg0L3QsCDQtNGA0YPQs9C+0Lkg0YHQtdC70LXQutGCXHJcbiAgLy8gXHJcblxyXG5cclxufSk7Il19
